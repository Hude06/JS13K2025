<!doctype html><title>Black Cat</title><script type=module>var e=e||{};e.VERSION="0.0.1",e.plugins=void 0,e.custom=void 0,e.create=function(t,a,i,r,n){var s,l={};if(l.canvas=document.createElement("canvas"),l.canvas.setAttribute("width",1*t),l.canvas.setAttribute("height",1*a),l.canvas.style.backgroundColor="black",document.body.appendChild(l.canvas),l.canvas.ctx=l.canvas.getContext("2d"),l.stage=(c(s={}),s.stage=!0,s.width=l.canvas.width,s.height=l.canvas.height,s.x=0,s.y=0,s.parent=void 0,s),l.pointer=(()=>{var e={_x:0,_y:0};return Object.defineProperties(e,{x:{get:()=>e._x/l.scale,enumerable:!0,configurable:!0},y:{get:()=>e._y/l.scale,enumerable:!0,configurable:!0},centerX:{get:()=>e.x,enumerable:!0,configurable:!0},centerY:{get:()=>e.y,enumerable:!0,configurable:!0},position:{get:()=>({x:e.x,y:e.y}),enumerable:!0,configurable:!0}}),e.isDown=!1,e.isUp=!0,e.tapped=!1,e.downTime=0,e.elapsedTime=0,e.press=void 0,e.release=void 0,e.tap=void 0,e.dragSprite=null,e.dragOffsetX=0,e.dragOffsetY=0,e.moveHandler=t=>{e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,t.preventDefault()},e.touchmoveHandler=t=>{e._x=t.targetTouches[0].pageX-l.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-l.canvas.offsetTop,t.preventDefault()},e.downHandler=t=>{e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.touchstartHandler=t=>{e._x=t.targetTouches[0].pageX-l.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-l.canvas.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.upHandler=t=>{e.elapsedTime=Math.abs(e.downTime-Date.now()),e.elapsedTime>200||(e.tapped=!0,e.tap&&e.tap()),e.isUp=!0,e.isDown=!1,e.release&&e.release(),t.preventDefault()},l.canvas.addEventListener("mousemove",e.moveHandler.bind(e),!1),l.canvas.addEventListener("mousedown",e.downHandler.bind(e),!1),window.addEventListener("mouseup",e.upHandler.bind(e),!1),l.canvas.addEventListener("touchmove",e.touchmoveHandler.bind(e),!1),l.canvas.addEventListener("touchstart",e.touchstartHandler.bind(e),!1),window.addEventListener("touchend",e.upHandler.bind(e),!1),l.canvas.style.touchAction="none",e.hitTestSprite=t=>{var a=!1;if(t.circular){var i=e.x-(t.gx+t.halfWidth),r=e.y-(t.gy+t.halfHeight);a=t.radius>Math.sqrt(i*i+r*r)}else a=e.x>t.gx&&t.gx+t.width>e.x&&e.y>t.gy&&t.gy+t.height>e.y;return a},e.updateDragAndDrop=()=>{if(e.isDown)if(null===e.dragSprite)for(var t=l.draggableSprites.length-1;t>-1;t--){var a=l.draggableSprites[t];if(a.draggable&&e.hitTestSprite(a)){e.dragOffsetX=e.x-a.gx,e.dragOffsetY=e.y-a.gy,e.dragSprite=a;var i=a.parent.children;i.splice(i.indexOf(a),1),i.push(a),l.draggableSprites.splice(l.draggableSprites.indexOf(a),1),l.draggableSprites.push(a);break}}else e.dragSprite.x=e.x-e.dragOffsetX,e.dragSprite.y=e.y-e.dragOffsetY;e.isUp&&(e.dragSprite=null),l.draggableSprites.some(t=>t.draggable&&e.hitTestSprite(t)?(l.canvas.style.cursor="pointer",!0):(l.canvas.style.cursor="auto",!1))},e})(),l.key=(()=>{var e={};return e.leftArrow=p(37),e.upArrow=p(38),e.rightArrow=p(39),e.downArrow=p(40),e.space=p(32),e.a=p(65),e.d=p(68),e.w=p(87),e.s=p(83),e.q=p(81),e.r=p(82),e})(),l.buttons=[],l.dragAndDrop=!1,l.draggableSprites=[],l.tweens=[],l.state=void 0,l.load=n||void 0,l.setup=i||void 0,void 0===l.setup)throw Error("Please supply the setup function in the constructor");function o(){if(requestAnimationFrame(o,l.canvas),void 0===l._fps)d(),l.render(l.canvas,0);else{var e=Date.now(),t=e-l._startTime;for(t>1e3&&(t=l._frameDuration),l._startTime=e,l._lag+=t;l._lag>=l._frameDuration;)h(),d(),l._lag-=l._frameDuration;l.render(l.canvas,l._lag/l._frameDuration)}}function h(){function e(t){t._previousX=t.x,t._previousY=t.y,t.children&&t.children.length>0&&t.children.forEach(t=>{e(t)})}l.stage.children.forEach(t=>{e(t)})}function d(){if(l.buttons.length>0){l.canvas.style.cursor="auto";for(var e=l.buttons.length-1;e>=0;e--){var t=l.buttons[e];t.update(l.pointer,l.canvas),"over"!==t.state&&"down"!==t.state||t.stage||(l.canvas.style.cursor="pointer")}}if(l.dragAndDrop&&l.pointer.updateDragAndDrop(),l.state&&!l.paused&&l.state(),0!==l.updateFunctions.length)for(var a=0;l.updateFunctions.length>a;a++)(0,l.updateFunctions[a])()}function c(e){e.x=0,e.y=0,e.vx=0,e.vy=0,e.width=0,e.height=0,e.scaleX=1,e.scaleY=1,e.pivotX=.5,e.pivotY=.5,e.rotation=0,e.visible=!0,e.parent=void 0,e.stage=!1,e.shadow=!1,e.shadowColor="rgba(100, 100, 100, 0.5)",e.shadowOffsetX=3,e.shadowOffsetY=3,e.shadowBlur=3,e.blendMode=void 0,e._alpha=1,e._draggable=void 0,e._layer=0,e._circular=!1,e._interactive=!1,e._previousX=void 0,e._previousY=void 0,e.children=[],e.addChild=t=>{t.parent&&t.parent.removeChild(t),t.parent=e,e.children.push(t)},e.removeChild=t=>{if(t.parent!==e)throw Error(t+"is not a child of "+e);e.children.splice(e.children.indexOf(t),1)},e.swapChildren=(t,a)=>{var i=e.children.indexOf(t),r=e.children.indexOf(a);if(-1===i||-1===r)throw Error(child+" Both objects must be a child of the caller "+e);t.childIndex=r,a.childIndex=i,e.children[i]=a,e.children[r]=t},e.add=function(t){var a=[].slice.call(arguments);a.length>1?a.forEach(t=>{e.addChild(t)}):e.addChild(a[0])},e.remove=function(t){var a=[].slice.call(arguments);a.length>1?a.forEach(t=>{e.removeChild(t)}):e.removeChild(a[0])},e.setPosition=(t,a)=>{e.x=t,e.y=a};var t=e;e.putCenter=(a,i,r)=>{r=r||0,a.x=t.x+t.halfWidth-a.halfWidth+(i=i||0),a.y=t.y+t.halfHeight-a.halfHeight+r,e.compensateForParentPosition(t,a)},e.putTop=(a,i,r)=>{r=r||0,a.x=t.x+t.halfWidth-a.halfWidth+(i=i||0),a.y=t.y-a.height+r,e.compensateForParentPosition(t,a)},e.putRight=(a,i,r)=>{r=r||0,a.x=t.x+t.width+(i=i||0),a.y=t.y+t.halfHeight-a.halfHeight+r,e.compensateForParentPosition(t,a)},e.putBottom=(a,i,r)=>{r=r||0,a.x=t.x+t.halfWidth-a.halfWidth+(i=i||0),a.y=t.y+t.height+r,e.compensateForParentPosition(t,a)},e.putLeft=(a,i,r)=>{r=r||0,a.x=t.x-a.width+(i=i||0),a.y=t.y+t.halfHeight-a.halfHeight+r,e.compensateForParentPosition(t,a)},e.compensateForParentPosition=(e,t)=>{0===t.parent.gx&&0===t.parent.gy||(t.x-=e.gx,t.y-=e.gy)},Object.defineProperties(e,{gx:{get(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},position:{get:()=>({x:e.x,y:e.y}),enumerable:!0,configurable:!0},alpha:{get:()=>e.parent._alpha*e._alpha,set(t){e._alpha=t},enumerable:!0,configurable:!0},halfWidth:{get:()=>e.width/2,enumerable:!0,configurable:!0},halfHeight:{get:()=>e.height/2,enumerable:!0,configurable:!0},centerX:{get:()=>e.x+e.halfWidth,enumerable:!0,configurable:!0},centerY:{get:()=>e.y+e.halfHeight,enumerable:!0,configurable:!0},layer:{get:()=>e._layer,set(t){e._layer=t,e.parent.children.sort(y)},enumerable:!0,configurable:!0},circular:{get:()=>e._circular,set(t){!0===t&&!1===e._circular&&(u(e),e._circular=!0),!1===t&&!0===e._circular&&(delete e.diameter,delete e.radius,e._circular=!1)},enumerable:!0,configurable:!0},draggable:{get:()=>e._draggable,set(t){!0===t&&(l.draggableSprites.push(e),e._draggable=!0,!1===l.dragAndDrop&&(l.dragAndDrop=!0)),!1===t&&l.draggableSprites.splice(l.draggableSprites.indexOf(e),1)},enumerable:!0,configurable:!0},interactive:{get:()=>e._interactive,set(t){!0===t&&(g(e),e._interactive=!0),!1===t&&(l.buttons.splice(l.buttons.indexOf(e),1),e._interactive=!1)},enumerable:!0,configurable:!0},localBounds:{get:()=>({x:0,y:0,width:e.width,height:e.height}),enumerable:!0,configurable:!0},globalBounds:{get:()=>(rectangle={x:e.gx,y:e.gy,width:e.gx+e.width,height:e.gy+e.height},rectangle),enumerable:!0,configurable:!0},empty:{get:()=>0===e.children.length,enumerable:!0,configurable:!0}})}function u(e){Object.defineProperties(e,{diameter:{get:()=>e.width,set(t){e.width=t,e.height=t},enumerable:!0,configurable:!0},radius:{get:()=>e.width/2,set(t){e.width=2*t,e.height=2*t},enumerable:!0,configurable:!0}})}function g(e){e.press=e.press||void 0,e.release=e.release||void 0,e.over=e.over||void 0,e.out=e.out||void 0,e.tap=e.tap||void 0,e.state="up",e.action="",e.pressed=!1,e.enabled=!0,e.hoverOver=!1,l.buttons.push(e),e.update=t=>{if(e.enabled){var a=l.pointer.hitTestSprite(e);t.isUp&&(e.state="up","button"===e.subtype&&e.show(0)),a&&(e.state="over",e.frames&&3===e.frames.length&&"button"===e.subtype&&e.show(1),t.isDown&&(e.state="down","button"===e.subtype&&e.show(3===e.frames.length?2:1))),"down"===e.state&&(e.pressed||(e.press&&e.press(),e.pressed=!0,e.action="pressed")),"over"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released",l.pointer.tapped&&e.tap&&e.tap()),e.hoverOver||(e.over&&e.over(),e.hoverOver=!0)),"up"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released"),e.hoverOver&&(e.out&&e.out(),e.hoverOver=!1))}}}function p(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=e=>{e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=e=>{e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function y(e,t){return t.layer>e.layer?-1:1}return l.assetFilePaths=r||void 0,l.paused=!1,l._fps=60,l._startTime=Date.now(),l._frameDuration=1e3/l._fps,l._lag=0,l.interpolate=!0,l.updateFunctions=[],l.scale=1,l.start=()=>{l.assetFilePaths?(l.assets.whenLoaded=()=>{l.state=void 0,l.setup()},l.assets.load(l.assetFilePaths),l.load&&(l.state=l.load)):l.setup(),o()},l.pause=()=>{l.paused=!0},l.resume=()=>{l.paused=!1},l.hidePointer=()=>{l.canvas.style.cursor="none"},l.showPointer=()=>{l.canvas.style.cursor="auto"},Object.defineProperties(l,{fps:{get:()=>l._fps,set(e){l._fps=e,l._startTime=Date.now(),l._frameDuration=1e3/l._fps},enumerable:!0,configurable:!0},backgroundColor:{set(e){l.canvas.style.backgroundColor=e},enumerable:!0,configurable:!0}}),l.remove=function(e){var t=[].slice.call(arguments);if(t[0]instanceof Array){var a=t[0];if(a.length>0)for(var i=a.length-1;i>=0;i--){var r=a[i];r.parent.removeChild(r),a.splice(a.indexOf(r),1)}}else t.length>1?t.forEach(e=>{e.parent.removeChild(e)}):t[0].parent.removeChild(t[0])},l.group=function(e){var t={};return c(t),t.addChild=e=>{e.parent&&e.parent.removeChild(e),e.parent=t,t.children.push(e),t.calculateSize()},t.removeChild=e=>{if(e.parent!==t)throw Error(e+"is not a child of "+t);t.children.splice(t.children.indexOf(e),1),t.calculateSize()},t.calculateSize=()=>{t.children.length>0&&(t._newWidth=0,t._newHeight=0,t.children.forEach(e=>{e.x+e.width>t._newWidth&&(t._newWidth=e.x+e.width),e.y+e.height>t._newHeight&&(t._newHeight=e.y+e.height)}),t.width=t._newWidth,t.height=t._newHeight)},l.stage.addChild(t),e&&[].slice.call(arguments).forEach(e=>{t.addChild(e)}),t},l.rectangle=(e,t,a,i,r,n,s)=>{var o={};return c(o),o.mask=!1,o.width=e||32,o.height=t||32,o.fillStyle=a||"red",o.strokeStyle=i||"none",o.lineWidth=r||0,o.x=n||0,o.y=s||0,l.stage.addChild(o),o.render=e=>{e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.fillStyle=o.fillStyle,e.beginPath(),e.rect(-o.width*o.pivotX,-o.height*o.pivotY,o.width,o.height),!0===o.mask?e.clip():("none"!==o.strokeStyle&&e.stroke(),"none"!==o.fillStyle&&e.fill())},o},l.circle=(e,t,a,i,r,n)=>{var s={};return c(s),s.mask=!1,s.width=e||32,s.height=e||32,s.fillStyle=t||"red",s.strokeStyle=a||"none",s.lineWidth=i||"none",s.x=r||0,s.y=n||0,l.stage.addChild(s),u(s),s.render=e=>{e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.fillStyle=s.fillStyle,e.beginPath(),e.arc(s.radius+-s.diameter*s.pivotX,s.radius+-s.diameter*s.pivotY,s.radius,0,2*Math.PI,!1),!0===s.mask?e.clip():("none"!==s.strokeStyle&&e.stroke(),"none"!==s.fillStyle&&e.fill())},s},l.line=(e,t,a,i,r,n)=>{var s={};return c(s),a||0===a||(a=0),i||0===i||(i=0),r||0===r||(r=32),n||0===n||(n=32),s.ax=a,s.ay=i,s.bx=r,s.by=n,s.strokeStyle=e||"red",s.lineWidth=t||1,s.lineJoin="round",l.stage.addChild(s),s.render=e=>{e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.lineJoin=s.lineJoin,e.beginPath(),e.moveTo(s.ax,s.ay),e.lineTo(s.bx,s.by),"none"!==s.strokeStyle&&e.stroke(),"none"!==s.fillStyle&&e.fill()},s},l.frame=(e,t,a,i,r)=>{var n={};return n.image=e,n.x=t,n.y=a,n.width=i,n.height=r,n},l.frames=(e,t,a,i)=>{var r={};return r.image=e,r.data=t,r.width=a,r.height=i,r},l.sprite=e=>{var t={};if(void 0===e)throw Error("Sprites require a source");return c(t),t.frames=[],t.loop=!0,t._currentFrame=0,t.setTexture=e=>{if(e.image)if(e.image&&!e.data){if(!(l.assets[e.image].source instanceof Image))throw Error(e.image+" is not an image file");t.source=l.assets[e.image].source,t.sourceX=e.x,t.sourceY=e.y,t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height}else e.image&&e.data&&(t.source=l.assets[e.image].source,t.frames=e.data,t.sourceX=t.frames[0][0],t.sourceY=t.frames[0][1],t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height);else e instanceof Array?(t.frames=e,t.source=l.assets[e[0]].source,t.sourceX=l.assets[e[0]].frame.x,t.sourceY=l.assets[e[0]].frame.y,t.width=l.assets[e[0]].frame.w,t.height=l.assets[e[0]].frame.h,t.sourceWidth=l.assets[e[0]].frame.w,t.sourceHeight=l.assets[e[0]].frame.h):(t.tilesetFrame=l.assets[e],t.source=t.tilesetFrame.source,t.sourceX=t.tilesetFrame.frame.x,t.sourceY=t.tilesetFrame.frame.y,t.width=t.tilesetFrame.frame.w,t.height=t.tilesetFrame.frame.h,t.sourceWidth=t.tilesetFrame.frame.w,t.sourceHeight=t.tilesetFrame.frame.h)},t.setTexture(e),t.gotoAndStop=e=>{if(0>=t.frames.length)throw Error("Frame number "+e+"doesn't exist");t.frames[0]instanceof Array?(t.sourceX=t.frames[e][0],t.sourceY=t.frames[e][1]):l.assets[t.frames[e]].frame&&(t.source=l.assets[t.frames[e]].source,t.sourceX=l.assets[t.frames[e]].frame.x,t.sourceY=l.assets[t.frames[e]].frame.y,t.sourceWidth=l.assets[t.frames[e]].frame.w,t.sourceHeight=l.assets[t.frames[e]].frame.h,t.width=l.assets[t.frames[e]].frame.w,t.height=l.assets[t.frames[e]].frame.h),t._currentFrame=e},t.x=0,t.y=0,t.frames.length>0&&(l.addStatePlayer(t),Object.defineProperty(t,"currentFrame",{get:()=>t._currentFrame,enumerable:!1,configurable:!1})),l.stage.addChild(t),t.render=e=>{e.drawImage(t.source,t.sourceX,t.sourceY,t.sourceWidth,t.sourceHeight,-t.width*t.pivotX,-t.height*t.pivotY,t.width,t.height)},t},l.button=e=>{var t=l.sprite(e);return t.subtype="button",g(t),t},l.image=e=>l.assets[e],l.json=e=>l.assets[e],l.addStatePlayer=function(e){var t=0,a=0,i=0,r=void 0,n=!1;function s(s){o(),a=s[1]-(i=s[0]),0===i&&(a+=1,t+=1),1===a&&(a=2,t+=1),e.fps||(e.fps=12);var h=1e3/e.fps;e.gotoAndStop(i),n||(r=setInterval(l.bind(this),h),n=!0)}function l(){a>t?(e.gotoAndStop(e.currentFrame+1),t+=1):e.loop&&(e.gotoAndStop(i),t=1)}function o(){void 0!==r&&!0===n&&(n=!1,t=0,i=0,a=0,clearInterval(r))}e.show=t=>{o(),e.gotoAndStop("string"!=typeof t?t:e.frames.indexOf(t))},e.play=()=>{s([0,e.frames.length-1])},e.stop=()=>{o(),e.gotoAndStop(e.currentFrame)},e.playing=n,e.playSequence=s},l.render=(e,t)=>{var a=e.ctx;a.clearRect(0,0,e.width,e.height);for(var i=0;l.stage.children.length>i;i++)r(l.stage.children[i]);function r(i){if(i.visible&&e.width+i.width>i.gx&&i.gx+i.width>=-i.width&&e.height+i.height>i.gy&&i.gy+i.height>=-i.height){if(a.save(),l.interpolate?(i.renderX=void 0!==i._previousX?(i.x-i._previousX)*t+i._previousX:i.x,i.renderY=void 0!==i._previousY?(i.y-i._previousY)*t+i._previousY:i.y):(i.renderX=i.x,i.renderY=i.y),a.translate(i.renderX+i.width*i.pivotX,i.renderY+i.height*i.pivotY),a.globalAlpha=i.alpha,a.rotate(i.rotation),a.scale(i.scaleX,i.scaleY),i.shadow&&(a.shadowColor=i.shadowColor,a.shadowOffsetX=i.shadowOffsetX,a.shadowOffsetY=i.shadowOffsetY,a.shadowBlur=i.shadowBlur),i.blendMode&&(a.globalCompositeOperation=i.blendMode),i.render&&i.render(a),i.children&&i.children.length>0){a.translate(-i.width*i.pivotX,-i.height*i.pivotY);for(var n=0;i.children.length>n;n++)r(i.children[n])}a.restore()}}},l.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif","webp"],fontExtensions:["ttf","otf","ttc","woff"],audioExtensions:["mp3","ogg","wav","webm"],jsonExtensions:["json"],whenLoaded:void 0,load(e){var t=this;t.toLoad=e.length,e.forEach(e=>{var a=e.split(".").pop();if(-1!==t.imageExtensions.indexOf(a)){var i=new Image;i.addEventListener("load",()=>{i.name=e,t[i.name]={source:i,frame:{x:0,y:0,w:i.width,h:i.height}},t.loadHandler()},!1),i.src=e}else if(-1!==t.fontExtensions.indexOf(a)){var r=e.split("/").pop().split(".")[0],n=document.createElement("style");n.appendChild(document.createTextNode("@font-face {font-family: '"+r+"'; src: url('"+e+"');}")),document.head.appendChild(n),t.loadHandler()}else if(-1!==t.audioExtensions.indexOf(a)){var s=l.makeSound(e,t.loadHandler.bind(t));s.name=e,t[s.name]=s}else if(-1!==t.jsonExtensions.indexOf(a)){var o=new XMLHttpRequest,h={};o.open("GET",e,!0),o.addEventListener("readystatechange",()=>{200===o.status&&4===o.readyState&&((h=JSON.parse(o.responseText)).name=e,t[h.name]=h,h.frames?t.createTilesetFrames(h,e):t.loadHandler())}),o.send()}})},createTilesetFrames(e,t){var a=this,i=t.replace(/[^\/]*$/,""),r=new Image;r.addEventListener("load",()=>{a[i+e.meta.image]={source:r,frame:{x:0,y:0,w:r.width,h:r.height}},Object.keys(e.frames).forEach(t=>{a[t]=e.frames[t],a[t].source=r}),a.loadHandler()},!1),r.src=i+e.meta.image},loadHandler(){var e=this;e.loaded+=1,e.toLoad===e.loaded&&(e.toLoad=0,e.loaded=0,e.whenLoaded())}},l.keyboard=p,l.makeDisplayObject=c,void 0!==e.plugins&&e.plugins(l),void 0!==e.custom&&e.custom(l),l},window.ga=e.create,function(e){var t,a,i={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},r=i.w3;for(a in i)if(i[a].enabled in e){t=i[a];break}function n(t,a){var i=e.createEvent("Event");i.initEvent(t,!0,!1),a.dispatchEvent(i)}!(r.enabled in e)&&t&&(e.addEventListener(t.events.change,a=>{e[r.enabled]=e[t.enabled],e[r.element]=e[t.element],n(r.events.change,a.target)},!1),e.addEventListener(t.events.error,e=>{n(r.events.error,e.target)},!1),e[r.enabled]=e[t.enabled],e[r.element]=e[t.element],e[r.exit]=e[t.exit],Element.prototype[r.request]=function(){return this[t.request].apply(this,arguments)})}(document),e.plugins=function(e){function t(e){e.x+=0|e.vx,e.y+=0|e.vy}e.move=e=>{if(e instanceof Array==0)t(e);else for(var a=0;e.length>a;a++)t(e[a])},e.distance=(e,t)=>{var a=t.centerX-e.centerX,i=t.centerY-e.centerY;return Math.sqrt(a*a+i*i)},e.randomInt=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,e.randomFloat=(e,t)=>e+Math.random()*(t-e),e.wait=(e,t)=>setTimeout(t,e),e.worldCamera=function(e,t){return{width:t.width,height:t.height,_x:0,_y:0,get x(){return this._x},set x(t){this._x=t,e.x=-this._x,e._previousX=e.x},get y(){return this._y},set y(t){this._y=t,e.y=-this._y,e._previousY=e.y},get centerX(){return this.x+this.width/2},get centerY(){return this.y+this.height/2},get rightInnerBoundary(){return this.x+this.width/2+this.width/4},get leftInnerBoundary(){return this.x+this.width/2-this.width/4},get topInnerBoundary(){return this.y+this.height/2-this.height/4},get bottomInnerBoundary(){return this.y+this.height/2+this.height/4},follow(t){this.leftInnerBoundary>t.x&&(this.x=t.x-this.width/4),this.topInnerBoundary>t.y&&(this.y=t.y-this.height/4),t.x+t.width>this.rightInnerBoundary&&(this.x=t.x+t.width-this.width/4*3),t.y+t.height>this.bottomInnerBoundary&&(this.y=t.y+t.height-this.height/4*3),0>this.x&&(this.x=0),0>this.y&&(this.y=0),this.x+this.width>e.width&&(this.x=e.width-this.width),this.y+this.height>e.height&&(this.y=e.height-this.height)},centerOver(e){this.x=e.x+e.halfWidth-this.width/2,this.y=e.y+e.halfHeight-this.height/2}}},e.scaleToWindow=t=>{var a,i,r,n,s;t=t||"#2C3539",a=window.innerWidth/e.canvas.width,i=window.innerHeight/e.canvas.height,r=Math.min(a,i),e.canvas.style.transformOrigin="0 0",e.canvas.style.transform="scale("+r+")","horizontally"==(n=e.canvas.width>e.canvas.height?e.canvas.width*r<window.innerWidth?"horizontally":"vertically":e.canvas.height*r<window.innerHeight?"vertically":"horizontally")&&(s=(window.innerWidth-e.canvas.width*r)/2,e.canvas.style.marginLeft=s+"px",e.canvas.style.marginRight=s+"px"),"vertically"===n&&(s=(window.innerHeight-e.canvas.height*r)/2,e.canvas.style.marginTop=s+"px",e.canvas.style.marginBottom=s+"px"),e.canvas.style.paddingLeft=0,e.canvas.style.paddingRight=0,e.canvas.style.paddingTop=0,e.canvas.style.paddingBottom=0,e.canvas.style.display="block",document.body.style.backgroundColor=t,e.pointer.scale=r,e.scale=r,e.canvas.scaled=!0;var l=navigator.userAgent.toLowerCase();-1!=l.indexOf("safari")&&(l.indexOf("chrome")>-1||(e.canvas.style.maxHeight="100%",e.canvas.style.minHeight="100%"))},e.scaleToFit=(t,a)=>{var i,r,n;"width"===t&&(i=e.canvas.width/window.innerWidth,r=e.canvas.height/window.innerHeight),"height"===t&&(i=window.innerWidth/e.canvas.width,r=window.innerHeight/e.canvas.height),n=Math.min(i,r),e.canvas.style.transformOrigin="0 0",e.canvas.style.transform="scale("+n+")",document.body.style.backgroundColor=a,e.canvas.style.paddingLeft=0,e.canvas.style.paddingRight=0,e.canvas.style.marginLeft="auto",e.canvas.style.marginRight="auto",e.canvas.style.display="block",e.canvas.style.minHeight="100%";var s=navigator.userAgent.toLowerCase();-1!=s.indexOf("safari")&&(s.indexOf("chrome")>-1||(e.canvas.style.maxHeight="100%",e.canvas.style.minHeight="100%")),e.scale=n},e.hitTestPoint=(e,t)=>{var a,i,r,n;return"rectangle"==(a=t.radius?"circle":"rectangle")&&(n=e.x>t.x&&t.x+t.width>e.x&&e.y>t.y&&t.y+t.height>e.y),"circle"===a&&(n=t.radius>Math.sqrt((i=e.x-t.centerX)*i+(r=e.y-t.centerY)*r)),n},e.hitTestCircle=(e,t,a)=>{var i,r;return void 0===a&&(a=!1),a?(i=t.gx+t.radius-(e.gx+e.radius),r=t.gy+t.radius-(e.gy+e.radius)):(i=t.centerX-e.centerX,r=t.centerY-e.centerY),e.radius+t.radius>Math.sqrt(i*i+r*r)},e.hitTestRectangle=(e,t,a)=>{var i,r,n;return void 0===a&&(a=!1),a?(r=e.gx+e.halfWidth-(t.gx+t.halfWidth),n=e.gy+e.halfHeight-(t.gy+t.halfHeight)):(r=e.centerX-t.centerX,n=e.centerY-t.centerY),i=e.halfHeight+t.halfHeight,e.halfWidth+t.halfWidth>Math.abs(r)&&i>Math.abs(n)},e.hitTestCircleRectangle=(t,a,i)=>{var r,n,s,l,o,h;if(void 0===i&&(i=!1),i?(s=t.gx,l=t.gy,o=a.gx,h=a.gy):(s=t.x,l=t.y,o=a.x,h=a.y),"topMiddle"==(r=h-a.halfHeight>l?o-1-a.halfWidth>s?"topLeft":s>o+1+a.halfWidth?"topRight":"topMiddle":l>h+a.halfHeight?o-1-a.halfWidth>s?"bottomLeft":s>o+1+a.halfWidth?"bottomRight":"bottomMiddle":o-a.halfWidth>s?"leftMiddle":"rightMiddle")||"bottomMiddle"===r||"leftMiddle"===r||"rightMiddle"===r)n=e.hitTestRectangle(t,a,i);else{var d={};switch(r){case"topLeft":d.x=o,d.y=h;break;case"topRight":d.x=o+a.width,d.y=h;break;case"bottomLeft":d.x=o,d.y=h+a.height;break;case"bottomRight":d.x=o+a.width,d.y=h+a.height}n=e.hitTestCirclePoint(t,d,i)}return n?r:n},e.hitTestCirclePoint=(t,a,i)=>(void 0===i&&(i=!1),a.diameter=1,a.radius=.5,a.centerX=a.x,a.centerY=a.y,a.gx=a.x,a.gy=a.y,e.hitTestCircle(t,a,i)),e.rectangleCollision=(e,t,a,i)=>{var r,n,s,l,o,h,d;return void 0===a&&(a=!1),void 0===i&&(i=!1),i?(h=e.gx+e.halfWidth-(t.gx+t.halfWidth),d=e.gy+e.halfHeight-(t.gy+t.halfHeight)):(h=e.centerX-t.centerX,d=e.centerY-t.centerY),s=e.halfHeight+t.halfHeight,(n=e.halfWidth+t.halfWidth)>Math.abs(h)&&s>Math.abs(d)&&(l=n-Math.abs(h),(o=s-Math.abs(d))>l?(h>0?(r="left",e.x=e.x+l):(r="right",e.x=e.x-l),a&&(e.vx*=-1)):(d>0?(r="top",e.y=e.y+o):(r="bottom",e.y=e.y-o),a&&(e.vy*=-1))),r},e.circleCollision=(e,t,a,i)=>{var r,n,s,l,o,h,d={},c=!1;return void 0===a&&(a=!0),void 0===i&&(i=!1),i?(l=t.gx+t.radius-(e.gx+e.radius),o=t.gy+t.radius-(e.gy+e.radius)):(l=t.centerX-e.centerX,o=t.centerY-e.centerY),(n=e.radius+t.radius)>(r=Math.sqrt(l*l+o*o))&&(c=!0,s=n-r,h=o/r,e.x-=(s+=.3)*(l/r),e.y-=s*h,a&&(d.x=o,d.y=-l,((e,t)=>{var a,i,r={},n={},s={},l=e.mass||1;t.lx=t.y,t.ly=-t.x,t.magnitude=Math.sqrt(t.x*t.x+t.y*t.y),t.dx=t.x/t.magnitude,t.dy=t.y/t.magnitude,r.vx=(a=e.vx*t.dx+e.vy*t.dy)*t.dx,r.vy=a*t.dy,n.vx=(i=e.vx*(t.lx/t.magnitude)+e.vy*(t.ly/t.magnitude))*(t.lx/t.magnitude),n.vy=i*(t.ly/t.magnitude),n.vx*=-1,n.vy*=-1,s.x=r.vx+n.vx,s.y=r.vy+n.vy,e.vx=s.x/l,e.vy=s.y/l})(e,d))),c},e.movingCircleCollision=(e,t,a)=>{var i,r,n,s,l={},o={},h={},d={},c={},u=!1;if(e.mass=e.mass||1,t.mass=t.mass||1,void 0===a&&(a=!1),a?(l.vx=t.gx+t.radius-(e.gx+e.radius),l.vy=t.gy+t.radius-(e.gy+e.radius)):(l.vx=t.centerX-e.centerX,l.vy=t.centerY-e.centerY),l.magnitude=Math.sqrt(l.vx*l.vx+l.vy*l.vy),(i=e.radius+t.radius)>l.magnitude){u=!0,r=i-l.magnitude,r+=.3,l.dx=l.vx/l.magnitude,l.dy=l.vy/l.magnitude,l.vxHalf=Math.abs(l.dx*r/2),l.vyHalf=Math.abs(l.dy*r/2),s=e.y>t.y?1:-1,e.x=e.x+l.vxHalf*(n=e.x>t.x?1:-1),e.y=e.y+l.vyHalf*s,t.x=t.x+l.vxHalf*-n,t.y=t.y+l.vyHalf*-s,l.lx=l.vy,l.ly=-l.vx;var g=e.vx*l.dx+e.vy*l.dy;o.x=g*l.dx,o.y=g*l.dy;var p=e.vx*(l.lx/l.magnitude)+e.vy*(l.ly/l.magnitude);h.x=p*(l.lx/l.magnitude),h.y=p*(l.ly/l.magnitude);var y=t.vx*l.dx+t.vy*l.dy;d.x=y*l.dx,d.y=y*l.dy;var f=t.vx*(l.lx/l.magnitude)+t.vy*(l.ly/l.magnitude);c.x=f*(l.lx/l.magnitude),c.y=f*(l.ly/l.magnitude),e.bounce={},e.bounce.x=h.x+d.x,e.bounce.y=h.y+d.y,t.bounce={},t.bounce.x=o.x+c.x,t.bounce.y=o.y+c.y,e.vx=e.bounce.x/e.mass,e.vy=e.bounce.y/e.mass,t.vx=t.bounce.x/t.mass,t.vy=t.bounce.y/t.mass}return u},e.multipleCircleCollision=(t,a)=>{void 0===a&&(a=!1);for(var i=0;t.length>i;i++)for(var r=t[i],n=i+1;t.length>n;n++)e.movingCircleCollision(r,t[n],a)},e.circlePointCollision=(t,a,i,r)=>(void 0===r&&(r=!1),void 0===i&&(i=!1),a.diameter=1,a.radius=.5,a.centerX=a.x,a.centerY=a.y,a.gx=a.x,a.gy=a.y,e.circleCollision(t,a,i,r)),e.circleRectangleCollision=(t,a,i,r)=>{var n,s,l,o,h,d;if(void 0===r&&(r=!1),void 0===i&&(i=!1),r?(l=t.gx,o=t.gy,h=a.gx,d=a.gy):(l=t.x,o=t.y,h=a.x,d=a.y),"topMiddle"==(n=d-a.halfHeight>o?h-1-a.halfWidth>l?"topLeft":l>h+1+a.halfWidth?"topRight":"topMiddle":o>d+a.halfHeight?h-1-a.halfWidth>l?"bottomLeft":l>h+1+a.halfWidth?"bottomRight":"bottomMiddle":h-a.halfWidth>l?"leftMiddle":"rightMiddle")||"bottomMiddle"===n||"leftMiddle"===n||"rightMiddle"===n)s=e.rectangleCollision(t,a,i,r);else{var c={};switch(n){case"topLeft":c.x=h,c.y=d;break;case"topRight":c.x=h+a.width,c.y=d;break;case"bottomLeft":c.x=h,c.y=d+a.height;break;case"bottomRight":c.x=h+a.width,c.y=d+a.height}s=e.circlePointCollision(t,c,i,r)}return s?n:s},e.hit=(t,a,i,r,n,s)=>{var l;return i=i||!1,r=r||!1,n=n||!1,a instanceof Array||t instanceof Array?(()=>{t instanceof Array&&(a=t);for(var e=a.length-1;e>=0;e--){var i=a[e];(l=o(t,i))&&s&&s(l,i)}})():(l=o(t,a))&&s&&s(l),l;function o(t,a){var s=void 0!==a.parent;if(void 0!==t.parent&&s)return t.diameter&&a.diameter?((t,a)=>i?t.vx+t.vy!==0&&a.vx+a.vy!==0?e.movingCircleCollision(t,a,n):e.circleCollision(t,a,r,n):e.hitTestCircle(t,a,n))(t,a):t.diameter&&!a.diameter?((t,a)=>i?e.circleRectangleCollision(t,a,r,n):e.hitTestCircleRectangle(t,a,n))(t,a):((t,a)=>i?e.rectangleCollision(t,a,!!r,n):e.hitTestRectangle(t,a,n))(t,a);if(s&&void 0!==t.x&&void 0!==t.y)return e.hitTestPoint(t,a);throw Error("I'm sorry, "+t+" and "+a+" cannot be use together in a collision test.")}},e.requestFullScreen=()=>{document.fullscreenEnabled||e.canvas.requestFullscreen()},e.exitFullScreen=()=>{document.fullscreenEnabled&&document.exitFullscreen()},e.alignFullscreen=()=>{var t,a;if(t=screen.width/e.canvas.width,a=screen.height/e.canvas.height,e.fullscreenScale=Math.min(t,a),0===document.styleSheets.length){var i=document.createElement("div");i.innerHTML="<style></style>",document.body.appendChild(i)}var r=navigator.userAgent.toLowerCase();e.canvas.width>e.canvas.height?-1!==r.indexOf("safari")||-1!==r.indexOf("chrome")?document.styleSheets[0].insertRule("canvas:-webkit-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain}",0):-1!==r.indexOf("firefox")?document.styleSheets[0].insertRule("canvas:-moz-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==r.indexOf("opera")?document.styleSheets[0].insertRule("canvas:-o-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==r.indexOf("explorer")?document.styleSheets[0].insertRule("canvas:-ms-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):document.styleSheets[0].insertRule("canvas:fullscreen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==r.indexOf("safari")||-1!==r.indexOf("chrome")?document.styleSheets[0].insertRule("canvas:-webkit-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==r.indexOf("firefox")?document.styleSheets[0].insertRule("canvas:-moz-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==r.indexOf("opera")?document.styleSheets[0].insertRule("canvas:-o-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==r.indexOf("msie")?document.styleSheets[0].insertRule("canvas:-ms-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):document.styleSheets[0].insertRule("canvas:fullscreen {height: 100%; margin: 0 auto; object-fit: contain;}",0)},e.enableFullscreen=function(t){t&&(t=[].slice.call(arguments)),e.alignFullscreen(),e.canvas.addEventListener("mouseup",e.requestFullScreen,!1),e.canvas.addEventListener("touchend",e.requestFullScreen,!1),t&&t.forEach(t=>{window.addEventListener("keyup",a=>{a.keyCode===t&&e.exitFullScreen(),a.preventDefault()},!1)})},e.launchFullscreen=t=>{e.hitTestPoint(e.pointer.position,t)&&e.enableFullscreen()},e.scaleFullscreen=()=>{document.fullscreenEnabled?(e.scale=e.fullscreenScale,e.pointer.scale=e.fullscreenScale):e.canvas.scaled||(e.scale=1,e.pointer.scale=1)},e.updateFunctions.push(e.scaleFullscreen)};let t=new AudioContext,a=(e=1,a=.05,i=220,r=0,n=0,s=.1,l=0,o=1,h=0,d=0,c=0,u=0,g=0,p=0,y=0,f=0,v=0,m=1,x=0,w=0,b=0)=>{let S=Math,M=2*S.PI,C=44100,_=h*=500*M/C/C,k=i*=(1-a+2*a*S.random(a=[]))*M/C,H=0,E=0,T=0,F=1,W=0,O=0,X=0,L=0>b?-1:1,Y=M*L*b*2/C,D=S.cos(Y),P=S.sin,R=P(Y)/4,A=1+R,q=-2*D/A,B=(1-R)/A,I=(1+L*D)/2/A,j=-(L+D)/A,z=I,U=0,J=0,N=0,G=0;for(d*=500*M/C**3,y*=M/C,c*=M/C,u*=C,g=C*g|0,e*=.3,L=(r=C*r+9)+(x*=C)+(n*=C)+(s*=C)+(v*=C)|0;L>T;a[T++]=X*e)++O%(100*f|0)||(X=l?l>1?l>2?l>3?P(H**3):S.max(S.min(S.tan(H),1),-1):1-(2*H/M%2+2)%2:1-4*S.abs(S.round(H/M)-H/M):P(H),X=(g?1-w+w*P(M*T/g):1)*(0>X?-1:1)*S.abs(X)**o*(r>T?T/r:r+x>T?1-(T-r)/x*(1-m):r+x+n>T?m:L-v>T?(L-T-v)/s*m:0),X=v?X/2+(v>T?0:(L-v>T?1:(L-T)/v)*a[T-v|0]/2/e):X,b&&(X=G=z*U+j*(U=J)+I*(J=X)-B*N-q*(N=G))),Y=(i+=h+=d)*S.cos(y*E++),H+=Y+Y*p*P(T**5),F&&++F>u&&(i+=c,k+=c,F=0),!g||++W%g||(i=k,h=_,F=F||1);(e=t.createBuffer(1,L,C)).getChannelData(0).set(a),(i=t.createBufferSource()).buffer=e,i.connect(t.destination),i.start()};class i{constructor(e){this.g=e,this.player=null,this.game=null,this.buildings=null,this.dropPoint=void 0,this.mouses=null,this.camera=void 0,this.gravity=.4,this.stars=null,this.topTowers=[],this.worldWidth=0}setup(){const e=this.g;this.game=e.group(),this.buildings=e.group(),this.mouses=e.group(),this.stars=e.group(),this.player=e.sprite("/Cat.png"),this.player.width=40,this.player.height=32,this.player.lastDropTime=0,this.player.dropCooldown=200,this.player.grounded=!1,this.player.canDropMice=!1,this.player.moveSpeed=3,this.player.speed=3,this.player.hurt=150,this.player.fallSpeed=0,this.player.x=e.canvas.width/2-this.player.width/2,this.levelTimeLimit=30,this.dropPoint=e.sprite("/Elevator.png"),this.player.layingMouses=e.group(),this.player.dropingElevator=!1,this.timeLimitSprite=c("hey",e.canvas.width-200,16,32,32),e.stage.addChild(this.timeLimitSprite),((e,t,a,i,r,s)=>{for(let e=0;30>e;e++)a.push(u(64*e,n.canvas.height,Math.floor(2*Math.random())+1));for(let e=0;5>e;e++){let t=h(64*e,a[e].y-22);i.addChild(t)}const l=Math.floor(s.x/64),o=Math.max(0,l-10),d=Math.min(a.length-1,l+10);let c=!1,g=null;for(;!c;){let e=Math.floor(Math.random()*(d-o+1))+o;5>e-l||(g=a[e],1>=g.height||(c=!0))}r.x=g.x+g.width/2-r.width/2,r.y=g.y-r.height})(0,0,this.topTowers,this.mouses,this.dropPoint,this.player);const t=(e=>{let t=null;for(let a=0;r.buildings.children.length>a;a++){const i=r.buildings.children[a];e>=i.x&&i.x+i.width>=e&&(t&&i.y>=t.y||(t=i))}return t})(this.player.x);this.player.y=t.y,this.worldWidth=64*this.topTowers.length,e.stage.width=this.worldWidth,e.stage.height=100*e.canvas.height,((e,t=100)=>{let a=[];for(let i=0;e>i;i++){let e,i=0;for(;50>i;){let s=Math.floor(Math.random()*(10*n.canvas.width-64)),l=Math.floor(Math.random()*(5*n.canvas.height/2-64));if(!a.some(e=>{let a=e.x-s,i=e.y-l;return t>Math.sqrt(a*a+i*i)})){e=n.sprite("/Star.png"),e.width=12,e.height=12,e.x=s,e.y=l,r.stars.addChild(e),a.push(e);break}i++}}})(1e3,100),this.game.addChild(this.stars),this.player.addChild(this.player.layingMouses),this.game.addChild(this.buildings),this.game.addChild(this.dropPoint),this.game.addChild(this.mouses),this.game.addChild(this.player),this.camera=e.worldCamera(this.game,e.canvas),this.keyboard(),e.state=g}keyboard(){const e=this.g;e.key.a.press=()=>{y()},e.key.a.release=()=>{e.key.d.isDown||(this.player.vx=0)},e.key.d.press=()=>{p()},e.key.d.release=()=>{e.key.a.isDown||(this.player.vx=0)},e.key.leftArrow.press=()=>{y()},e.key.leftArrow.release=()=>{e.key.rightArrow.isDown||(this.player.vx=0)},e.key.rightArrow.press=()=>{p()},e.key.rightArrow.release=()=>{e.key.leftArrow.isDown||(this.player.vx=0)},e.key.upArrow.press=()=>{f()},e.key.space.press=()=>{f()},e.key.w.press=()=>{f()},e.key.r.press=()=>{o()},e.key.q.release=async()=>{if(this.player.dropingElevator)this.player.layingMouses.removeChild(this.player.layingMouses.children[this.player.layingMouses.children.length-1]),this.player.canDropMice=!1,this.player.moveSpeed=this.player.speed-this.player.layingMouses.children.length/5,s(),0===this.mouses.children.length&&0===this.player.layingMouses.children.length&&o();else if(this.player.layingMouses.children.length>0){await d(this.player),this.player.layingMouses.removeChild(this.player.layingMouses.children[0]);let e=h(this.player.x-25,d(this.player).y-22);r.mouses.addChild(e),this.player.moveSpeed=this.player.speed-this.player.layingMouses.children.length/5}}}}let r=null;const n=e.create(800,512,()=>{r&&"function"==typeof r.setup&&r.setup()},["/Cat.png","/Mouse_Stand.png","/Mouse_Lay.png","/Roof1.png","/Roof2.png","/Star.png","/WhiteFont.png","/Elevator.png"]);function s(){a(...[,,488,.02,.01,.07,,.7,,162,,,,,,,,.82,.04])}r=new i(n),e.plugins(n),n.start(),n.scaleToWindow(),n.canvas.ctx.imageSmoothingEnabled=!1,n.canvas.style.border="2px black solid",n.backgroundColor="black",window.addEventListener("resize",()=>{n.scaleToWindow()});let l=new class{constructor(){this.menuText=null,this.menuBackground=null}};function o(){n.state=g,n.remove(r.dropPoint),n.remove(r.player.layingMouses),n.remove(r.player),n.remove(r.stars),n.remove(r.buildings),n.remove(r.mouses),n.remove(r.timeLimitSprite),r=new i(n),r.setup()}function h(e,t){let a=n.sprite("/Mouse_Stand.png");return a.width=22,a.height=22,a.x=e,a.y=t,a}function d(e){let t=null;for(let a=0;r.buildings.children.length>a;a++){let i=r.buildings.children[a];e.x+e.width>i.x&&i.x+i.width>e.x&&(t&&i.y>=t.y||(t=i))}return t}function c(e,t,a,i,r){const s=i,l=r;let o=n.group();for(let i=0;e.length>i;i++){let r=e[i].toUpperCase(),h="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(r);if(-1===h)continue;let d=n.sprite("/WhiteFont.png");d.sourceX=5*h,d.sourceY=0,d.sourceWidth=5,d.sourceHeight=5,d.width=s,d.height=l,d.x=t+i*s,d.y=a,o.addChild(d)}return o}function u(e,t,a){let i=1===a?"Roof1.png":"Roof2.png",s=null,l=Math.floor(10*Math.random()),o=r.buildings.lastHeight||10,h=Math.max(1,o-2),d=o+3,c=Math.floor(Math.random()*(d-h+1))+h;for(;1===c;)h=Math.max(1,o-2),d=o+2,c=Math.floor(Math.random()*(d-h+1))+h;3===l&&(c=1);for(let a=0;c>a;a++){let l=n.sprite("/"+i);l.width=64,l.height=32,l.x=e,l.y=t-32*a,r.buildings.addChild(l),s&&l.y>=s.y||(s=l)}return 3!==l&&(r.buildings.lastHeight=c),s}function g(){l.menuBackground||l.menuText||(l.menuBackground=n.rectangle(50*n.canvas.width,100*n.canvas.height,"black","none",0,-1e3,-500),n.stage.addChild(l.menuBackground),l.menuText=c("THE MIDNIGHT EXPRESS",75,200,32,32),n.stage.addChild(l.menuText)),n.key.space.isDown&&(n.remove(l.menuBackground),n.remove(l.menuText),l.menuBackground=null,l.menuText=null,n.state=v)}function p(){if(r.player.vx=r.player.moveSpeed,r.player.scaleX=1,r.player.layingMouses.children.length>0)for(let e=0;r.player.layingMouses.children.length>e;e++)r.player.layingMouses.children[e].scaleX=1,r.player.layingMouses.children[e].offset=5}function y(){if(r.player.vx=-r.player.moveSpeed,r.player.scaleX=-1,r.player.layingMouses.children.length>0)for(let e=0;r.player.layingMouses.children.length>e;e++)r.player.layingMouses.children[e].scaleX=-1,r.player.layingMouses.children[e].offset=20}function f(){s(),r.player.grounded&&(r.player.vy-=10,r.player.grounded=!1)}function v(){r.player.vy+=r.gravity,n.move(r.player),r.levelTimeLimit-=.01,n.remove(r.timeLimitSprite),r.timeLimitSprite=c(r.levelTimeLimit+"",n.canvas.width-90,16,32,32),0>r.levelTimeLimit&&o();for(let e=0;r.buildings.children.length>e;e++){let t=r.buildings.children[e];n.hit(r.player,t,!0,!1,!1,e=>{"top"===e?r.player.vy=0:"bottom"!==e||0>r.player.vy?"left"!==e&&"right"!==e||(r.player.vx=0):(r.player.vy=0,r.player.grounded=!0,r.player.fallSpeed>15&&(r.player.hurt+=Math.floor(10*r.player.fallSpeed),0>r.player.hurt&&(r.player.hurt=0),r.player.hurt>150&&o(),a(...[,,50,.1,.2,.6,4,1.5])),r.player.y=t.y-r.player.height,r.player.vy=-r.gravity),"bottom"!==e&&r.player.vy>0&&(r.player.grounded=!1)})}r.player.dropingElevator=!!n.hit(r.player,r.dropPoint,!1,!1,!1),r.player.fallSpeed=r.player.vy;for(let e=0;r.mouses.children.length>e;e++){const t=r.mouses.children[e];n.hit(r.player,t,!0,!1,!1,()=>{const e=n.sprite("/Mouse_Lay.png");e.width=20,e.height=20,e.x=r.player.x,e.y=r.player.y-20,e.layer=2,e.offset=0,r.player.layingMouses.addChild(e),r.mouses.removeChild(t),r.player.moveSpeed=r.player.speed-r.player.layingMouses.children.length/6})}for(let e=0;r.player.layingMouses.children.length>e;e++){const t=r.player.layingMouses.children[e];t.x=(1===r.player.scaleX?3:19)-r.player.layingMouses.children[e].offset,t.y=r.player.height-10*e-25}for(let e=0;r.stars.children.length>e;e++)r.stars.children[e].x-=.05;r.camera.centerOver(r.player)}</script>