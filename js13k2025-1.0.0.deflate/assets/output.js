(()=>{let e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(let e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(var t of e)if("childList"===t.type)for(let e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&n(e)}).observe(document,{childList:!0,subtree:!0})}function n(e){var t,n;e.ep||(e.ep=!0,n={},(t=e).integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),n.credentials="use-credentials"===t.crossOrigin?"include":"anonymous"===t.crossOrigin?"omit":"same-origin",fetch(e.href,n))}})();var e=e||{};e.VERSION="0.0.1",e.plugins=void 0,e.custom=void 0,e.create=function(t,n,i,r,a){var o,u={};if(u.canvas=document.createElement("canvas"),u.canvas.setAttribute("width",+t),u.canvas.setAttribute("height",+n),u.canvas.style.backgroundColor="black",document.body.appendChild(u.canvas),u.canvas.ctx=u.canvas.getContext("2d"),u.stage=(c(t={}),t.stage=!0,t.width=u.canvas.width,t.height=u.canvas.height,t.x=0,t.y=0,t.parent=void 0,t),u.pointer=(o={_x:0,_y:0},Object.defineProperties(o,{x:{get:function(){return o._x/u.scale},enumerable:!0,configurable:!0},y:{get:function(){return o._y/u.scale},enumerable:!0,configurable:!0},centerX:{get:function(){return o.x},enumerable:!0,configurable:!0},centerY:{get:function(){return o.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:o.x,y:o.y}},enumerable:!0,configurable:!0}}),o.isDown=!1,o.isUp=!0,o.tapped=!1,o.downTime=0,o.elapsedTime=0,o.press=void 0,o.release=void 0,o.tap=void 0,o.dragSprite=null,o.dragOffsetX=0,o.dragOffsetY=0,o.moveHandler=function(e){o._x=e.pageX-e.target.offsetLeft,o._y=e.pageY-e.target.offsetTop,e.preventDefault()},o.touchmoveHandler=function(e){o._x=e.targetTouches[0].pageX-u.canvas.offsetLeft,o._y=e.targetTouches[0].pageY-u.canvas.offsetTop,e.preventDefault()},o.downHandler=function(e){o._x=e.pageX-e.target.offsetLeft,o._y=e.pageY-e.target.offsetTop,o.isDown=!0,o.isUp=!1,o.tapped=!1,o.downTime=Date.now(),o.press&&o.press(),e.preventDefault()},o.touchstartHandler=function(e){o._x=e.targetTouches[0].pageX-u.canvas.offsetLeft,o._y=e.targetTouches[0].pageY-u.canvas.offsetTop,o.isDown=!0,o.isUp=!1,o.tapped=!1,o.downTime=Date.now(),o.press&&o.press(),e.preventDefault()},o.upHandler=function(e){o.elapsedTime=Math.abs(o.downTime-Date.now()),o.elapsedTime<=200&&(o.tapped=!0,o.tap)&&o.tap(),o.isUp=!0,o.isDown=!1,o.release&&o.release(),e.preventDefault()},u.canvas.addEventListener("mousemove",o.moveHandler.bind(o),!1),u.canvas.addEventListener("mousedown",o.downHandler.bind(o),!1),window.addEventListener("mouseup",o.upHandler.bind(o),!1),u.canvas.addEventListener("touchmove",o.touchmoveHandler.bind(o),!1),u.canvas.addEventListener("touchstart",o.touchstartHandler.bind(o),!1),window.addEventListener("touchend",o.upHandler.bind(o),!1),u.canvas.style.touchAction="none",o.hitTestSprite=function(e){var t,n;return e.circular?(n=o.x-(e.gx+e.halfWidth),t=o.y-(e.gy+e.halfHeight),Math.sqrt(n*n+t*t)<e.radius):(n=e.gx,o.x>n&&o.x<e.gx+e.width&&o.y>e.gy&&o.y<e.gy+e.height)},o.updateDragAndDrop=function(){if(o.isDown)if(null===o.dragSprite)for(var e=u.draggableSprites.length-1;-1<e;e--){var t=u.draggableSprites[e];if(t.draggable&&o.hitTestSprite(t)){o.dragOffsetX=o.x-t.gx,o.dragOffsetY=o.y-t.gy;var n=(o.dragSprite=t).parent.children;n.splice(n.indexOf(t),1),n.push(t),u.draggableSprites.splice(u.draggableSprites.indexOf(t),1),u.draggableSprites.push(t);break}}else o.dragSprite.x=o.x-o.dragOffsetX,o.dragSprite.y=o.y-o.dragOffsetY;o.isUp&&(o.dragSprite=null),u.draggableSprites.some(function(e){return e.draggable&&o.hitTestSprite(e)?(u.canvas.style.cursor="pointer",!0):!(u.canvas.style.cursor="auto")})},o),u.key=((n={}).leftArrow=f(37),n.upArrow=f(38),n.rightArrow=f(39),n.downArrow=f(40),n.space=f(32),n.a=f(65),n.d=f(68),n.w=f(87),n.s=f(83),n),u.buttons=[],u.dragAndDrop=!1,u.draggableSprites=[],u.tweens=[],u.state=void 0,u.load=a||void 0,u.setup=i||void 0,void 0===u.setup)throw new Error("Please supply the setup function in the constructor");function s(){if(requestAnimationFrame(s,u.canvas),void 0===u._fps)l(),u.render(u.canvas,0);else{var e=Date.now(),t=e-u._startTime;for(1e3<t&&(t=u._frameDuration),u._startTime=e,u._lag+=t;u._lag>=u._frameDuration;)u.stage.children.forEach(function(e){!function t(e){e._previousX=e.x,e._previousY=e.y,e.children&&0<e.children.length&&e.children.forEach(function(e){t(e)})}(e)}),l(),u._lag-=u._frameDuration;e=u._lag/u._frameDuration;u.render(u.canvas,e)}}function l(){if(0<u.buttons.length){u.canvas.style.cursor="auto";for(var e=u.buttons.length-1;0<=e;e--){var t=u.buttons[e];t.update(u.pointer,u.canvas),"over"!==t.state&&"down"!==t.state||t.stage||(u.canvas.style.cursor="pointer")}}if(u.dragAndDrop&&u.pointer.updateDragAndDrop(),u.state&&!u.paused&&u.state(),0!==u.updateFunctions.length)for(var n=0;n<u.updateFunctions.length;n++)(0,u.updateFunctions[n])()}function c(r){r.x=0,r.y=0,r.vx=0,r.vy=0,r.width=0,r.height=0,r.scaleX=1,r.scaleY=1,r.pivotX=.5,r.pivotY=.5,r.rotation=0,r.visible=!0,r.parent=void 0,r.stage=!1,r.shadow=!1,r.shadowColor="rgba(100, 100, 100, 0.5)",r.shadowOffsetX=3,r.shadowOffsetY=3,r.shadowBlur=3,r.blendMode=void 0,r._alpha=1,r._draggable=void 0,r._layer=0,r._circular=!1,r._interactive=!1,r._previousX=void 0,r._previousY=void 0,r.children=[],r.addChild=function(e){e.parent&&e.parent.removeChild(e),(e.parent=r).children.push(e)},r.removeChild=function(e){if(e.parent!==r)throw new Error(e+"is not a child of "+r);r.children.splice(r.children.indexOf(e),1)},r.swapChildren=function(e,t){var n=r.children.indexOf(e),i=r.children.indexOf(t);if(-1===n||-1===i)throw new Error(child+" Both objects must be a child of the caller "+r);e.childIndex=i,t.childIndex=n,r.children[n]=t,r.children[i]=e},r.add=function(e){var t=Array.prototype.slice.call(arguments);1<t.length?t.forEach(function(e){r.addChild(e)}):r.addChild(t[0])},r.remove=function(e){var t=Array.prototype.slice.call(arguments);1<t.length?t.forEach(function(e){r.removeChild(e)}):r.removeChild(t[0])},r.setPosition=function(e,t){r.x=e,r.y=t};var i=r;r.putCenter=function(e,t,n){n=n||0,e.x=i.x+i.halfWidth-e.halfWidth+(t=t||0),e.y=i.y+i.halfHeight-e.halfHeight+n,r.compensateForParentPosition(i,e)},r.putTop=function(e,t,n){n=n||0,e.x=i.x+i.halfWidth-e.halfWidth+(t=t||0),e.y=i.y-e.height+n,r.compensateForParentPosition(i,e)},r.putRight=function(e,t,n){n=n||0,e.x=i.x+i.width+(t=t||0),e.y=i.y+i.halfHeight-e.halfHeight+n,r.compensateForParentPosition(i,e)},r.putBottom=function(e,t,n){n=n||0,e.x=i.x+i.halfWidth-e.halfWidth+(t=t||0),e.y=i.y+i.height+n,r.compensateForParentPosition(i,e)},r.putLeft=function(e,t,n){n=n||0,e.x=i.x-e.width+(t=t||0),e.y=i.y+i.halfHeight-e.halfHeight+n,r.compensateForParentPosition(i,e)},r.compensateForParentPosition=function(e,t){0===t.parent.gx&&0===t.parent.gy||(t.x-=e.gx,t.y-=e.gy)},Object.defineProperties(r,{gx:{get:function(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get:function(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:r.x,y:r.y}},enumerable:!0,configurable:!0},alpha:{get:function(){return r.parent._alpha*r._alpha},set:function(e){r._alpha=e},enumerable:!0,configurable:!0},halfWidth:{get:function(){return r.width/2},enumerable:!0,configurable:!0},halfHeight:{get:function(){return r.height/2},enumerable:!0,configurable:!0},centerX:{get:function(){return r.x+r.halfWidth},enumerable:!0,configurable:!0},centerY:{get:function(){return r.y+r.halfHeight},enumerable:!0,configurable:!0},layer:{get:function(){return r._layer},set:function(e){r._layer=e,r.parent.children.sort(g)},enumerable:!0,configurable:!0},circular:{get:function(){return r._circular},set:function(e){!0===e&&!1===r._circular&&(d(r),r._circular=!0),!1===e&&!0===r._circular&&(delete r.diameter,delete r.radius,r._circular=!1)},enumerable:!0,configurable:!0},draggable:{get:function(){return r._draggable},set:function(e){!0===e&&(u.draggableSprites.push(r),!(r._draggable=!0)===u.dragAndDrop)&&(u.dragAndDrop=!0),!1===e&&u.draggableSprites.splice(u.draggableSprites.indexOf(r),1)},enumerable:!0,configurable:!0},interactive:{get:function(){return r._interactive},set:function(e){!0===e&&(h(r),r._interactive=!0),!1===e&&(u.buttons.splice(u.buttons.indexOf(r),1),r._interactive=!1)},enumerable:!0,configurable:!0},localBounds:{get:function(){return{x:0,y:0,width:r.width,height:r.height}},enumerable:!0,configurable:!0},globalBounds:{get:function(){return rectangle={x:r.gx,y:r.gy,width:r.gx+r.width,height:r.gy+r.height}},enumerable:!0,configurable:!0},empty:{get:function(){return 0===r.children.length},enumerable:!0,configurable:!0}})}function d(t){Object.defineProperties(t,{diameter:{get:function(){return t.width},set:function(e){t.width=e,t.height=e},enumerable:!0,configurable:!0},radius:{get:function(){return t.width/2},set:function(e){t.width=2*e,t.height=2*e},enumerable:!0,configurable:!0}})}function h(i){i.press=i.press||void 0,i.release=i.release||void 0,i.over=i.over||void 0,i.out=i.out||void 0,i.tap=i.tap||void 0,i.state="up",i.action="",i.pressed=!1,i.enabled=!0,i.hoverOver=!1,u.buttons.push(i),i.update=function(e,t){var n;i.enabled&&(n=u.pointer.hitTestSprite(i),e.isUp&&(i.state="up","button"===i.subtype)&&i.show(0),n&&(i.state="over",i.frames&&3===i.frames.length&&"button"===i.subtype&&i.show(1),e.isDown)&&(i.state="down","button"===i.subtype)&&(3===i.frames.length?i.show(2):i.show(1)),"down"!==i.state||i.pressed||(i.press&&i.press(),i.pressed=!0,i.action="pressed"),"over"===i.state&&(i.pressed&&(i.release&&i.release(),i.pressed=!1,i.action="released",u.pointer.tapped)&&i.tap&&i.tap(),i.hoverOver||(i.over&&i.over(),i.hoverOver=!0)),"up"===i.state)&&(i.pressed&&(i.release&&i.release(),i.pressed=!1,i.action="released"),i.hoverOver)&&(i.out&&i.out(),i.hoverOver=!1)}}function f(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function g(e,t){return e.layer<t.layer?-1:(e.layer,t.layer,1)}return u.assetFilePaths=r||void 0,u.paused=!1,u._fps=60,u._startTime=Date.now(),u._frameDuration=1e3/u._fps,u._lag=0,u.interpolate=!0,u.updateFunctions=[],u.scale=1,u.start=function(){u.assetFilePaths?(u.assets.whenLoaded=function(){u.state=void 0,u.setup()},u.assets.load(u.assetFilePaths),u.load&&(u.state=u.load)):u.setup(),s()},u.pause=function(){u.paused=!0},u.resume=function(){u.paused=!1},u.hidePointer=function(){u.canvas.style.cursor="none"},u.showPointer=function(){u.canvas.style.cursor="auto"},Object.defineProperties(u,{fps:{get:function(){return u._fps},set:function(e){u._fps=e,u._startTime=Date.now(),u._frameDuration=1e3/u._fps},enumerable:!0,configurable:!0},backgroundColor:{set:function(e){u.canvas.style.backgroundColor=e},enumerable:!0,configurable:!0}}),u.remove=function(e){var t=Array.prototype.slice.call(arguments);if(t[0]instanceof Array){var n=t[0];if(0<n.length)for(var i=n.length-1;0<=i;i--){var r=n[i];r.parent.removeChild(r),n.splice(n.indexOf(r),1)}}else 1<t.length?t.forEach(function(e){e.parent.removeChild(e)}):t[0].parent.removeChild(t[0])},u.group=function(e){var t={};return c(t),t.addChild=function(e){e.parent&&e.parent.removeChild(e),(e.parent=t).children.push(e),t.calculateSize()},t.removeChild=function(e){if(e.parent!==t)throw new Error(e+"is not a child of "+t);t.children.splice(t.children.indexOf(e),1),t.calculateSize()},t.calculateSize=function(){0<t.children.length&&(t._newWidth=0,t._newHeight=0,t.children.forEach(function(e){e.x+e.width>t._newWidth&&(t._newWidth=e.x+e.width),e.y+e.height>t._newHeight&&(t._newHeight=e.y+e.height)}),t.width=t._newWidth,t.height=t._newHeight)},u.stage.addChild(t),e&&Array.prototype.slice.call(arguments).forEach(function(e){t.addChild(e)}),t},u.rectangle=function(e,t,n,i,r,a,o){var s={};return c(s),s.mask=!1,s.width=e||32,s.height=t||32,s.fillStyle=n||"red",s.strokeStyle=i||"none",s.lineWidth=r||0,s.x=a||0,s.y=o||0,u.stage.addChild(s),s.render=function(e){e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.fillStyle=s.fillStyle,e.beginPath(),e.rect(-s.width*s.pivotX,-s.height*s.pivotY,s.width,s.height),!0===s.mask?e.clip():("none"!==s.strokeStyle&&e.stroke(),"none"!==s.fillStyle&&e.fill())},s},u.circle=function(e,t,n,i,r,a){var o={};return c(o),o.mask=!1,o.width=e||32,o.height=e||32,o.fillStyle=t||"red",o.strokeStyle=n||"none",o.lineWidth=i||"none",o.x=r||0,o.y=a||0,u.stage.addChild(o),d(o),o.render=function(e){e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.fillStyle=o.fillStyle,e.beginPath(),e.arc(o.radius+-o.diameter*o.pivotX,o.radius+-o.diameter*o.pivotY,o.radius,0,2*Math.PI,!1),!0===o.mask?e.clip():("none"!==o.strokeStyle&&e.stroke(),"none"!==o.fillStyle&&e.fill())},o},u.line=function(e,t,n,i,r,a){var o={};return c(o),i||0===i||(i=0),r||0===r||(r=32),a||0===a||(a=32),o.ax=n=n||0===n?n:0,o.ay=i,o.bx=r,o.by=a,o.strokeStyle=e||"red",o.lineWidth=t||1,o.lineJoin="round",u.stage.addChild(o),o.render=function(e){e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.lineJoin=o.lineJoin,e.beginPath(),e.moveTo(o.ax,o.ay),e.lineTo(o.bx,o.by),"none"!==o.strokeStyle&&e.stroke(),"none"!==o.fillStyle&&e.fill()},o},u.text=function(e,t,n,i,r){var a={};return c(a),a.content=e||"Hello!",a.font=t||"12px sans-serif",a.fillStyle=n||"red",a.textBaseline="top",Object.defineProperties(a,{width:{get:function(){return u.canvas.ctx.measureText(a.content).width},enumerable:!0,configurable:!0},height:{get:function(){return u.canvas.ctx.measureText("M").width},enumerable:!0,configurable:!0}}),u.stage.addChild(a),a.x=i||0,a.y=r||0,a.render=function(e){e.strokeStyle=a.strokeStyle,e.lineWidth=a.lineWidth,e.fillStyle=a.fillStyle,0===a.width&&(a.width=e.measureText(a.content).width),0===a.height&&(a.height=e.measureText("M").width),e.translate(-a.width*a.pivotX,-a.height*a.pivotY),e.font=a.font,e.textBaseline=a.textBaseline,e.fillText(a.content,0,0)},a},u.frame=function(e,t,n,i,r){var a={};return a.image=e,a.x=t,a.y=n,a.width=i,a.height=r,a},u.frames=function(e,t,n,i){var r={};return r.image=e,r.data=t,r.width=n,r.height=i,r},u.filmstrip=function(e,t,n,i){for(var r=u.assets[e].source,a=[],o=r.width/t,s=r.height/n*o,l=0;l<s;l++){var c=l%o*t,d=Math.floor(l/o)*n;i&&0<i&&(c+=i+i*l%o,d+=i+i*Math.floor(l/o)),a.push([c,d])}return u.frames(e,a,t,n)},u.sprite=function(e){var t={};if(void 0===e)throw new Error("Sprites require a source");return c(t),t.frames=[],t.loop=!0,t._currentFrame=0,t.setTexture=function(e){if(e.image)if(e.image,e.data)e.image&&e.data&&(t.source=u.assets[e.image].source,t.frames=e.data,t.sourceX=t.frames[0][0],t.sourceY=t.frames[0][1],t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height);else{if(!(u.assets[e.image].source instanceof Image))throw new Error(e.image+" is not an image file");t.source=u.assets[e.image].source,t.sourceX=e.x,t.sourceY=e.y,t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height}else e instanceof Array?(t.frames=e,t.source=u.assets[e[0]].source,t.sourceX=u.assets[e[0]].frame.x,t.sourceY=u.assets[e[0]].frame.y,t.width=u.assets[e[0]].frame.w,t.height=u.assets[e[0]].frame.h,t.sourceWidth=u.assets[e[0]].frame.w,t.sourceHeight=u.assets[e[0]].frame.h):(t.tilesetFrame=u.assets[e],t.source=t.tilesetFrame.source,t.sourceX=t.tilesetFrame.frame.x,t.sourceY=t.tilesetFrame.frame.y,t.width=t.tilesetFrame.frame.w,t.height=t.tilesetFrame.frame.h,t.sourceWidth=t.tilesetFrame.frame.w,t.sourceHeight=t.tilesetFrame.frame.h)},t.setTexture(e),t.gotoAndStop=function(e){if(!(0<t.frames.length))throw new Error("Frame number "+e+"doesn't exist");t.frames[0]instanceof Array?(t.sourceX=t.frames[e][0],t.sourceY=t.frames[e][1]):u.assets[t.frames[e]].frame&&(t.source=u.assets[t.frames[e]].source,t.sourceX=u.assets[t.frames[e]].frame.x,t.sourceY=u.assets[t.frames[e]].frame.y,t.sourceWidth=u.assets[t.frames[e]].frame.w,t.sourceHeight=u.assets[t.frames[e]].frame.h,t.width=u.assets[t.frames[e]].frame.w,t.height=u.assets[t.frames[e]].frame.h),t._currentFrame=e},t.x=0,(t.y=0)<t.frames.length&&(u.addStatePlayer(t),Object.defineProperty(t,"currentFrame",{get:function(){return t._currentFrame},enumerable:!1,configurable:!1})),u.stage.addChild(t),t.render=function(e){e.drawImage(t.source,t.sourceX,t.sourceY,t.sourceWidth,t.sourceHeight,-t.width*t.pivotX,-t.height*t.pivotY,t.width,t.height)},t},u.button=function(e){e=u.sprite(e);return e.subtype="button",h(e),e},u.image=function(e){return u.assets[e]},u.json=function(e){return u.assets[e]},u.addStatePlayer=function(t){var n=0,i=0,r=0,a=void 0,o=!1;function e(e){s(),r=e[0],i=e[1]-r,0===r&&(i+=1,n+=1),1===i&&(i=2,n+=1),t.fps||(t.fps=12);e=1e3/t.fps;t.gotoAndStop(r),o||(a=setInterval(function(){n<i?(t.gotoAndStop(t.currentFrame+1),n+=1):t.loop&&(t.gotoAndStop(r),n=1)}.bind(this),e),o=!0)}function s(){void 0!==a&&!0===o&&(o=!1,i=r=n=0,clearInterval(a))}t.show=function(e){s(),"string"!=typeof e?t.gotoAndStop(e):t.gotoAndStop(t.frames.indexOf(e))},t.play=function(){e([0,t.frames.length-1])},t.stop=function(){s(),t.gotoAndStop(t.currentFrame)},t.playing=o,t.playSequence=e},u.render=function(i,r){var a=i.ctx;a.clearRect(0,0,i.width,i.height);for(var e=0;e<u.stage.children.length;e++)!function e(t){if(t.visible&&t.gx<i.width+t.width&&t.gx+t.width>=-t.width&&t.gy<i.height+t.height&&t.gy+t.height>=-t.height){if(a.save(),u.interpolate?(void 0!==t._previousX?t.renderX=(t.x-t._previousX)*r+t._previousX:t.renderX=t.x,void 0!==t._previousY?t.renderY=(t.y-t._previousY)*r+t._previousY:t.renderY=t.y):(t.renderX=t.x,t.renderY=t.y),a.translate(t.renderX+t.width*t.pivotX,t.renderY+t.height*t.pivotY),a.globalAlpha=t.alpha,a.rotate(t.rotation),a.scale(t.scaleX,t.scaleY),t.shadow&&(a.shadowColor=t.shadowColor,a.shadowOffsetX=t.shadowOffsetX,a.shadowOffsetY=t.shadowOffsetY,a.shadowBlur=t.shadowBlur),t.blendMode&&(a.globalCompositeOperation=t.blendMode),t.render&&t.render(a),t.children&&0<t.children.length){a.translate(-t.width*t.pivotX,-t.height*t.pivotY);for(var n=0;n<t.children.length;n++)e(t.children[n])}a.restore()}}(u.stage.children[e])},u.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif","webp"],fontExtensions:["ttf","otf","ttc","woff"],audioExtensions:["mp3","ogg","wav","webm"],jsonExtensions:["json"],whenLoaded:void 0,load:function(e){var s=this;s.toLoad=e.length,e.forEach(function(e){var t,n,i,r,a,o=e.split(".").pop();-1!==s.imageExtensions.indexOf(o)?((t=new Image).addEventListener("load",function(){t.name=e,s[t.name]={source:t,frame:{x:0,y:0,w:t.width,h:t.height}},s.loadHandler()},!1),t.src=e):-1!==s.fontExtensions.indexOf(o)?(i=e.split("/").pop().split(".")[0],(n=document.createElement("style")).appendChild(document.createTextNode("@font-face {font-family: '"+i+"'; src: url('"+e+"');}")),document.head.appendChild(n),s.loadHandler()):-1!==s.audioExtensions.indexOf(o)?((i=u.makeSound(e,s.loadHandler.bind(s))).name=e,s[i.name]=i):-1!==s.jsonExtensions.indexOf(o)&&(r=new XMLHttpRequest,a={},r.open("GET",e,!0),r.addEventListener("readystatechange",function(){200===r.status&&4===r.readyState&&((a=JSON.parse(r.responseText)).name=e,(s[a.name]=a).frames?s.createTilesetFrames(a,e):s.loadHandler())}),r.send())})},createTilesetFrames:function(t,e){var n=this,i=e.replace(/[^\/]*$/,""),r=new Image;r.addEventListener("load",function(){n[i+t.meta.image]={source:r,frame:{x:0,y:0,w:r.width,h:r.height}},Object.keys(t.frames).forEach(function(e){n[e]=t.frames[e],n[e].source=r}),n.loadHandler()},!1),r.src=i+t.meta.image},loadHandler:function(){this.loaded+=1,this.toLoad===this.loaded&&(this.toLoad=0,this.loaded=0,this.whenLoaded())}},u.keyboard=f,u.makeDisplayObject=c,void 0!==e.plugins&&e.plugins(u),void 0!==e.custom&&e.custom(u),u},window.ga=e.create,(i=>{var t,e,n={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},r=n.w3;for(e in n)if(n[e].enabled in i){t=n[e];break}function a(e,t){var n=i.createEvent("Event");n.initEvent(e,!0,!1),t.dispatchEvent(n)}r.enabled in i||!t||(i.addEventListener(t.events.change,function(e){i[r.enabled]=i[t.enabled],i[r.element]=i[t.element],a(r.events.change,e.target)},!1),i.addEventListener(t.events.error,function(e){a(r.events.error,e.target)},!1),i[r.enabled]=i[t.enabled],i[r.element]=i[t.element],i[r.exit]=i[t.exit],Element.prototype[r.request]=function(){return this[t.request].apply(this,arguments)})})(document),e.plugins=function(k){function n(e){e.x+=0|e.vx,e.y+=0|e.vy}k.move=function(e){if(e instanceof Array==0)n(e);else for(var t=0;t<e.length;t++)n(e[t])},k.distance=function(e,t){var n=t.centerX-e.centerX,t=t.centerY-e.centerY;return Math.sqrt(n*n+t*t)},k.followEase=function(e,t,n){var i=t.centerX-e.centerX,t=t.centerY-e.centerY;1<=Math.sqrt(i*i+t*t)&&(e.x+=i*n,e.y+=t*n)},k.followConstant=function(e,t,n){var i=t.centerX-e.centerX,t=t.centerY-e.centerY,r=Math.sqrt(i*i+t*t);n<=r&&(e.x+=i/r*n,e.y+=t/r*n)},k.rotateAroundSprite=function(e,t,n,i){e.x=t.centerX-e.parent.x+n*Math.cos(i)-e.halfWidth,e.y=t.centerY-e.parent.y+n*Math.sin(i)-e.halfWidth},k.rotateAroundPoint=function(e,t,n,i,r){var a={};return a.x=e+Math.cos(r)*n,a.y=t+Math.sin(r)*i,a},k.angle=function(e,t){return Math.atan2(t.centerY-e.centerY,t.centerX-e.centerX)},k.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},k.randomFloat=function(e,t){return e+Math.random()*(t-e)},k.wait=function(e,t){return setTimeout(t,e)},k.worldCamera=function(t,e){return{width:e.width,height:e.height,_x:0,_y:0,get x(){return this._x},set x(e){this._x=e,t.x=-this._x,t._previousX=t.x},get y(){return this._y},set y(e){this._y=e,t.y=-this._y,t._previousY=t.y},get centerX(){return this.x+this.width/2},get centerY(){return this.y+this.height/2},get rightInnerBoundary(){return this.x+this.width/2+this.width/4},get leftInnerBoundary(){return this.x+this.width/2-this.width/4},get topInnerBoundary(){return this.y+this.height/2-this.height/4},get bottomInnerBoundary(){return this.y+this.height/2+this.height/4},follow:function(e){e.x<this.leftInnerBoundary&&(this.x=e.x-this.width/4),e.y<this.topInnerBoundary&&(this.y=e.y-this.height/4),e.x+e.width>this.rightInnerBoundary&&(this.x=e.x+e.width-this.width/4*3),e.y+e.height>this.bottomInnerBoundary&&(this.y=e.y+e.height-this.height/4*3),this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x+this.width>t.width&&(this.x=t.width-this.width),this.y+this.height>t.height&&(this.y=t.height-this.height)},centerOver:function(e){this.x=e.x+e.halfWidth-this.width/2,this.y=e.y+e.halfHeight-this.height/2}}},k.scaleToWindow=function(e){e=e||"#2C3539",t=window.innerWidth/k.canvas.width,i=window.innerHeight/k.canvas.height,t=Math.min(t,i),k.canvas.style.transformOrigin="0 0",k.canvas.style.transform="scale("+t+")","horizontally"==(i=k.canvas.width>k.canvas.height?k.canvas.width*t<window.innerWidth?"horizontally":"vertically":k.canvas.height*t<window.innerHeight?"vertically":"horizontally")&&(n=(window.innerWidth-k.canvas.width*t)/2,k.canvas.style.marginLeft=n+"px",k.canvas.style.marginRight=n+"px"),"vertically"==i&&(n=(window.innerHeight-k.canvas.height*t)/2,k.canvas.style.marginTop=n+"px",k.canvas.style.marginBottom=n+"px"),k.canvas.style.paddingLeft=0,k.canvas.style.paddingRight=0,k.canvas.style.paddingTop=0,k.canvas.style.paddingBottom=0,k.canvas.style.display="block",document.body.style.backgroundColor=e,k.pointer.scale=t,k.scale=t,k.canvas.scaled=!0;var t,n,i=navigator.userAgent.toLowerCase();-1==i.indexOf("safari")||-1<i.indexOf("chrome")||(k.canvas.style.maxHeight="100%",k.canvas.style.minHeight="100%")},k.scaleToFit=function(e,t){"width"===e&&(i=k.canvas.width/window.innerWidth,n=k.canvas.height/window.innerHeight),"height"===e&&(i=window.innerWidth/k.canvas.width,n=window.innerHeight/k.canvas.height),e=Math.min(i,n),k.canvas.style.transformOrigin="0 0",k.canvas.style.transform="scale("+e+")",document.body.style.backgroundColor=t,k.canvas.style.paddingLeft=0,k.canvas.style.paddingRight=0,k.canvas.style.marginLeft="auto",k.canvas.style.marginRight="auto",k.canvas.style.display="block",k.canvas.style.minHeight="100%";var n,i=navigator.userAgent.toLowerCase();-1==i.indexOf("safari")||-1<i.indexOf("chrome")||(k.canvas.style.maxHeight="100%",k.canvas.style.minHeight="100%"),k.scale=e},k.shakingSprites=[],k.updateShakingSprites=function(){if(0<k.shakingSprites.length)for(var e=k.shakingSprites.length-1;0<=e;e--){var t=k.shakingSprites[e];t.updateShake&&t.updateShake()}},k.updateFunctions.push(k.updateShakingSprites),k.shake=function(e,t,n){void 0===t&&(t=16),void 0===n&&(n=!1);function i(e,t){return Math.floor(Math.random()*(t-e+1))+e}var r=1,a=e.x,o=e.y,s=e.rotation,l=t/10,c=(-1===k.shakingSprites.indexOf(e)&&(k.shakingSprites.push(e),e.updateShake=function(){n?(r<10&&(e.rotation=s,t-=l,e.rotation=t*c,r+=1,c*=-1),10<=r&&(e.rotation=s,k.shakingSprites.splice(k.shakingSprites.indexOf(e),1))):(r<10&&(e.x=a,e.y=o,t-=l,e.x+=i(-t,t),e.y+=i(-t,t),r+=1),10<=r&&(e.x=a,e.y=o,k.shakingSprites.splice(k.shakingSprites.indexOf(e),1)))}),1)},k.tweens=[],k.updateTweens=function(){if(0<k.tweens.length)for(var e=k.tweens.length-1;0<=e;e--){var t=k.tweens[e];t&&t.update()}},k.updateFunctions.push(k.updateTweens),k.cubicBezier=function(e,t,n,i,r){var a=e*e;return t+(3*-t+e*(3*t-t*e))*e+(3*n+e*(-6*n+3*n*e))*e+(3*i-3*i*e)*a+r*(a*e)};var d={linear:function(e){return e},smoothstep:function(e){return e*e*(3-2*e)},smoothstepSquared:function(e){return Math.pow(e*e*(3-2*e),2)},smoothstepCubed:function(e){return Math.pow(e*e*(3-2*e),3)},acceleration:function(e){return e*e},accelerationCubed:function(e){return Math.pow(e*e,3)},deceleration:function(e){return 1-Math.pow(1-e,2)},decelerationCubed:function(e){return 1-Math.pow(1-e,3)},sine:function(e){return Math.sin(e*Math.PI/2)},sineSquared:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},sineCubed:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},inverseSine:function(e){return 1-Math.sin((1-e)*Math.PI/2)},inverseSineSquared:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),2)},inverseSineCubed:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),3)},spline:function(e,t,n,i,r){return.5*(2*n+(-t+i)*e+(2*t-5*n+4*i-r)*e*e+(3*n-t-3*i+r)*e*e*e)}};k.tweenProperty=function(t,n,e,i,r,a,o,s){void 0===r&&(r=60),void 0===o&&(o=!1),void 0===s&&(s=0);var l={},c=(a=void 0===a?"smoothstep":a).split(" ");return"bounce"===c[0]&&(l.startMagnitude=parseInt(c[1]),l.endMagnitude=parseInt(c[2])),l.start=function(e,t){l.startValue=JSON.parse(JSON.stringify(e)),l.endValue=JSON.parse(JSON.stringify(t)),l.playing=!0,l.totalFrames=r,l.frameCounter=0,k.tweens.push(l)},l.start(e,i),l.update=function(){var e;l.playing&&(l.frameCounter<l.totalFrames?(e=l.frameCounter/l.totalFrames,e="bounce"!==c[0]?d[a](e):d.spline(e,l.startMagnitude,0,1,l.endMagnitude),t[n]=l.endValue*e+l.startValue*(1-e),l.frameCounter+=1):l.end())},l.end=function(){l.playing=!1,l.onComplete&&l.onComplete(),k.tweens.splice(k.tweens.indexOf(l),1),o&&k.wait(s,function(){l.start(l.endValue,l.startValue)})},l.play=function(){l.playing=!0},l.pause=function(){l.playing=!1},l},k.fadeOut=function(e,t){return k.tweenProperty(e,"alpha",e.alpha,0,t=void 0===t?60:t,"sine")},k.fadeIn=function(e,t){return k.tweenProperty(e,"alpha",e.alpha,1,t=void 0===t?60:t,"sine")},k.pulse=function(e,t,n){return k.tweenProperty(e,"alpha",e.alpha,n=void 0===n?0:n,t=void 0===t?60:t,"smoothstep",!0)},k.makeTween=function(e){var t={tweens:[]},n=(e.forEach(function(e){e=k.tweenProperty(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);t.tweens.push(e)}),0);return t.completed=function(){(n+=1)===t.tweens.length&&(t.onComplete&&t.onComplete(),n=0)},t.tweens.forEach(function(e){e.onComplete=function(){t.completed()}}),t.pause=function(){t.tweens.forEach(function(e){e.playing=!1})},t.play=function(){t.tweens.forEach(function(e){e.playing=!0})},t},k.slide=function(e,t,n,i,r,a,o){return k.makeTween([[e,"x",e.x,t,i=void 0===i?60:i,r=void 0===r?"smoothstep":r,a=void 0===a?!1:a,o=void 0===o?0:o],[e,"y",e.y,n,i,r,a,o]])},k.breathe=function(e,t,n,i,r,a){return k.makeTween([[e,"scaleX",e.scaleX,t,i=void 0===i?60:i,"smoothstepSquared",r=void 0===r?!0:r,a=void 0===a?0:a],[e,"scaleY",e.scaleY,n,i,"smoothstepSquared",r,a]])},k.scale=function(e,t,n,i){return k.makeTween([[e,"scaleX",e.scaleX,t,i=void 0===i?60:i,"smoothstep",!1],[e,"scaleY",e.scaleY,n,i,"smoothstep",!1]])},k.strobe=function(e,t,n,i,r,a,o){n="bounce "+(n=void 0===n?10:n)+" "+(i=void 0===i?20:i);return k.makeTween([[e,"scaleX",e.scaleX,t=void 0===t?1.3:t,r=void 0===r?10:r,n,a=void 0===a?!0:a,o=void 0===o?0:o],[e,"scaleY",e.scaleY,t,r,n,a,o]])},k.wobble=function(e,t,n,i,r,a,o,s,l,c,d){void 0===l&&(l=.98);t=k.makeTween([[e,"scaleX",e.scaleX,t=void 0===t?1.2:t,i=void 0===i?10:i,"bounce "+(r=void 0===r?10:r)+" "+(a=void 0===a?10:a),c=void 0===c?!0:c,d=void 0===d?0:d],[e,"scaleY",e.scaleY,n=void 0===n?1.2:n,i,"bounce "+(o=void 0===o?-10:o)+" "+(s=void 0===s?-10:s),c,d]]);return t.tweens.forEach(function(e){e.onComplete=function(){1<e.endValue&&(e.endValue*=l,e.endValue<=1)&&(e.endValue=1,k.removeTween(e))}}),t},k.removeTween=function(e){e.tweens?(e.pause(),e.tweens.forEach(function(e){k.tweens.splice(k.tweens.indexOf(e),1)})):(e.pause(),k.tweens.splice(k.tweens.indexOf(e),1))},k.followCurve=function(n,e,t,i,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);var o={},s=(i=void 0===i?"smoothstep":i).split(" ");return"bounce"===s[0]&&(o.startMagnitude=parseInt(s[1]),o.endMagnitude=parseInt(s[2])),o.start=function(e){o.playing=!0,o.totalFrames=t,o.frameCounter=0,o.pointsArray=JSON.parse(JSON.stringify(e)),k.tweens.push(o)},o.start(e),o.update=function(){var e,t=o.pointsArray;o.playing&&(o.frameCounter<o.totalFrames?(e=o.frameCounter/o.totalFrames,e="bounce"!==s[0]?d[i](e):d.spline(e,o.startMagnitude,0,1,o.endMagnitude),n.x=k.cubicBezier(e,t[0][0],t[1][0],t[2][0],t[3][0]),n.y=k.cubicBezier(e,t[0][1],t[1][1],t[2][1],t[3][1]),o.frameCounter+=1):o.end())},o.end=function(){o.playing=!1,o.onComplete&&o.onComplete(),k.tweens.splice(k.tweens.indexOf(o),1),r&&k.wait(a,function(){o.pointsArray=o.pointsArray.reverse(),o.start(o.pointsArray)})},o.pause=function(){o.playing=!1},o.play=function(){o.playing=!0},o},k.walkPath=function(i,e,t,r,a,o,s){void 0===t&&(t=300),void 0===r&&(r="smoothstep"),void 0===a&&(a=!1),void 0===o&&(o=!1),void 0===s&&(s=0);var l=JSON.parse(JSON.stringify(e)),c=t/l.length;return function e(t){var n=k.makeTween([[i,"x",l[t][0],l[t+1][0],c,r],[i,"y",l[t][1],l[t+1][1],c,r]]);return n.onComplete=function(){(t+=1)<l.length-1?k.wait(s,function(){n=e(t)}):a&&(o&&l.reverse(),k.wait(s,function(){t=0,i.x=l[0][0],i.y=l[0][1],n=e(t)}))},n}(0)},k.walkCurve=function(i,r,e,a,o,s,l){void 0===a&&(a="smoothstep"),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===l&&(l=0);var c=(e=void 0===e?300:e)/r.length;return function e(t){var n=k.followCurve(i,r[t],c,a);return n.onComplete=function(){(t+=1)<r.length?k.wait(l,function(){n=e(t)}):o&&(s&&(r.reverse(),r.forEach(function(e){e.reverse()})),k.wait(l,function(){t=0,i.x=r[0][0],i.y=r[0][1],n=e(t)}))},n}(0)},k.shoot=function(e,t,n,i,r,a){a=a();return a.x=e.centerX-a.halfWidth+n*Math.cos(t),a.y=e.centerY-a.halfHeight+n*Math.sin(t),a.vx=Math.cos(t)*i,a.vy=Math.sin(t)*i,r.push(a),a},k.grid=function(a,o,s,l,c,d,u,h,f){void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=32),void 0===l&&(l=32),void 0===d&&(d=0),void 0===u&&(u=0),void 0===c&&(c=!1);var g=k.group();return g.createGrid=function(){for(var e=a*o,t=0;t<e;t++){var n=t%a*s,i=Math.floor(t/a)*l,r=h();g.addChild(r),c?(r.x=n+s/2-r.halfWidth+d,r.y=i+l/2-r.halfHeight+u):(r.x=n+d,r.y=i+u),f&&f(r)}},g.createGrid(),k.stage.addChild(g),g},k.progressBar={maxWidth:0,height:0,backgroundColor:"gray",foregroundColor:"cyan",backBar:null,frontBar:null,percentage:null,assets:null,initialized:!1,create:function(e,t){this.initialized||(this.assets=t,this.maxWidth=k.canvas.width/2,this.backBar=k.rectangle(this.maxWidth,32,this.backgroundColor),this.backBar.x=k.canvas.width/2-this.maxWidth/2,this.backBar.y=k.canvas.height/2-16,this.frontBar=k.rectangle(this.maxWidth,32,this.foregroundColor),this.frontBar.x=k.canvas.width/2-this.maxWidth/2,this.frontBar.y=k.canvas.height/2-16,this.percentage=k.text("0%","28px sans-serif","black"),this.percentage.x=k.canvas.width/2-this.maxWidth/2+12,this.percentage.y=k.canvas.height/2-12,this.initialized=!0)},update:function(){var e=(k.assets.loaded+1)/k.assets.toLoad;this.frontBar.width=this.maxWidth*e,this.percentage.content=Math.floor(100*e)+"%"},remove:function(){k.remove(this.frontBar),k.remove(this.backBar),k.remove(this.percentage)}},k.particles=[],k.particleEffect=function(i,r,a,e,o,t,n,s,l,c,d,u,h,f,g,p,v,y){void 0===i&&(i=0),void 0===r&&(r=0),void 0===a&&(a=function(){return k.circle(10,"red")}),void 0===o&&(o=0),void 0===t&&(t=!0),void 0===l&&(l=4),void 0===c&&(c=16),void 0===d&&(d=.1),void 0===u&&(u=1),void 0===h&&(h=.01),void 0===f&&(f=.05),void 0===g&&(g=.02),void 0===p&&(p=.02),void 0===v&&(v=.01),void 0===y&&(y=.03);for(var m,x=function(e,t){return e+Math.random()*(t-e)},w=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},b=[],S=((s=void 0===s?6.28:s)-(n=void 0===n?0:n))/((e=void 0===e?10:e)-1),M=0;M<e;M++)t?(m=x(n,s),b.push(m)):(void 0===m&&(m=n),b.push(m),m+=S);b.forEach(function(e){var t,n;e=e,0<(t=a()).frames.length&&t.gotoAndStop(w(0,t.frames.length-1)),t.x=i-t.halfWidth,t.y=r-t.halfHeight,n=w(l,c),t.width=n,t.height=n,t.scaleSpeed=x(h,f),t.alphaSpeed=x(g,p),t.rotationSpeed=x(v,y),n=x(d,u),t.vx=n*Math.cos(e),t.vy=n*Math.sin(e),t.updateParticle=function(){t.vy+=o,t.x+=t.vx,t.y+=t.vy,0<t.scaleX-t.scaleSpeed&&(t.scaleX-=t.scaleSpeed),0<t.scaleY-t.scaleSpeed&&(t.scaleY-=t.scaleSpeed),t.rotation+=t.rotationSpeed,t.alpha-=t.alphaSpeed,t.alpha<=0&&(k.remove(t),k.particles.splice(k.particles.indexOf(t),1))},k.particles.push(t)})},k.updateParticles=function(){if(0<k.particles.length)for(var e=k.particles.length-1;0<=e;e--)k.particles[e].updateParticle()},k.updateFunctions.push(k.updateParticles),k.emitter=function(e,t){var n={},i=void 0;return n.playing=!1,n.play=function(){n.playing||(t(),i=setInterval(function(){t()}.bind(this),e),n.playing=!0)},n.stop=function(){n.playing&&(clearInterval(i),n.playing=!1)},n},k.tilingSprite=function(e,t,n,i,r){void 0===i&&(i=0),void 0===r&&(r=0),o=k.assets[n].frame?(a=k.assets[n].frame.w,k.assets[n].frame.h):(a=k.assets[n].width,k.assets[n].height),s=a<=e?Math.round(e/a)+1:2,l=o<=t?Math.round(t/o)+1:2;var a,o,s,l,c=k.grid(s,l,a,o,!1,0,0,function(){return k.sprite(n)}),e=(c._tileX=0,c._tileY=0,k.rectangle(e,t,"none","none"));return e.x=i,e.y=r,e.mask=!0,e.addChild(c),Object.defineProperties(e,{tileX:{get:function(){return c._tileX},set:function(n){c.children.forEach(function(e){var t=n-c._tileX;e.x+=t,(s-1)*a<e.x&&(e.x=0-a+t),e.x<0-a-t&&(e.x=(s-1)*a)}),c._tileX=n},enumerable:!0,configurable:!0},tileY:{get:function(){return c._tileY},set:function(n){c.children.forEach(function(e){var t=n-c._tileY;e.y+=t,(l-1)*o<e.y&&(e.y=0-o+t),e.y<0-o-t&&(e.y=(l-1)*o)}),c._tileY=n},enumerable:!0,configurable:!0}}),e},k.burst=function(n,i,r,e,a,o,s,l,c,d,u,h,f,g){var p;for(n=n||0,i=i||0,r=r||function(){return k.circle(10,"red")},a=a||4,o=o||16,e=e||10,s=s||.1,l=l||1,c=c||.01,d=d||.05,u=u||.02,h=h||.02,f=f||.01,g=g||.03,p=0;p<360;p+=Math.round(360/e))(()=>{var e=r(),t=(e.x=n-e.halfWidth,e.y=i-e.halfHeight,k.randomFloat(a,o)),t=(e.width=t,e.height=t,e.scaleSpeed=k.randomFloat(c,d),e.alphaSpeed=k.randomFloat(u,h),e.rotationSpeed=k.randomFloat(f,g),k.randomFloat(s,l));e.vx=t*Math.cos(p*Math.PI/180),e.vy=t*Math.sin(p*Math.PI/180),e.update=function(){e.x+=e.vx,e.y+=e.vy,0<e.scaleX-e.scaleSpeed&&(e.scaleX-=e.scaleSpeed),0<e.scaleY-e.scaleSpeed&&(e.scaleY-=e.scaleSpeed),e.rotation+=e.rotationSpeed,e.alpha-=e.alphaSpeed,e.alpha<=0&&(k.remove(e),k.particles.splice(k.particles.indexOf(e),1))},k.particles.push(e)})()},k.outsideBounds=function(e,t,n){var i,r=t.x;return e.x<r-e.width&&(i="left"),e.y<t.y-e.height&&(i="top"),t.width<e.x&&(i="right"),(i=t.height<e.y?"bottom":i)&&n&&n(i),i},k.contain=function(e,t,n,i){var r,a=t.x,o=t.y,s=t.width,t=t.height;return n=n||!1,e.x<a&&(n&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=a,r="left"),e.y<o&&(n&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=o,r="top"),s<e.x+e.width&&(n&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=s-e.width,r="right"),t<e.y+e.height&&(n&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=t-e.height,r="bottom"),r&&i&&i(r),r},k.hitTestPoint=function(e,t){var n,i;return"rectangle"==(n=t.radius?"circle":"rectangle")&&(i=t.x,i=e.x>i&&e.x<t.x+t.width&&e.y>t.y&&e.y<t.y+t.height),"circle"==n&&(n=e.x-t.centerX,e=e.y-t.centerY,i=Math.sqrt(n*n+e*e)<t.radius),i},k.hitTestCircle=function(e,t,n){var i,n=(n=void 0===n?!1:n)?(i=t.gx+t.radius-(e.gx+e.radius),t.gy+t.radius-(e.gy+e.radius)):(i=t.centerX-e.centerX,t.centerY-e.centerY);return Math.sqrt(i*i+n*n)<e.radius+t.radius},k.hitTestRectangle=function(e,t,n){var i,n=(n=void 0===n?!1:n)?(i=e.gx+e.halfWidth-(t.gx+t.halfWidth),e.gy+e.halfHeight-(t.gy+t.halfHeight)):(i=e.centerX-t.centerX,e.centerY-t.centerY),r=e.halfWidth+t.halfWidth,e=e.halfHeight+t.halfHeight;return Math.abs(i)<r&&Math.abs(n)<e},k.hitTestCircleRectangle=function(e,t,n){var i,r,a,o,s=(n=void 0===n?!1:n)?(r=e.gx,a=e.gy,o=t.gx,t.gy):(r=e.x,a=e.y,o=t.x,t.y);if("topMiddle"==(a=a<s-t.halfHeight?r<o-1-t.halfWidth?"topLeft":r>o+1+t.halfWidth?"topRight":"topMiddle":a>s+t.halfHeight?r<o-1-t.halfWidth?"bottomLeft":r>o+1+t.halfWidth?"bottomRight":"bottomMiddle":r<o-t.halfWidth?"leftMiddle":"rightMiddle")||"bottomMiddle"==a||"leftMiddle"==a||"rightMiddle"==a)i=k.hitTestRectangle(e,t,n);else{var l={};switch(a){case"topLeft":l.x=o,l.y=s;break;case"topRight":l.x=o+t.width,l.y=s;break;case"bottomLeft":l.x=o,l.y=s+t.height;break;case"bottomRight":l.x=o+t.width,l.y=s+t.height}i=k.hitTestCirclePoint(e,l,n)}return i&&a},k.hitTestCirclePoint=function(e,t,n){return void 0===n&&(n=!1),t.diameter=1,t.radius=.5,t.centerX=t.x,t.centerY=t.y,t.gx=t.x,t.gy=t.y,k.hitTestCircle(e,t,n)},k.rectangleCollision=function(e,t,n,i){var r,a,o;return void 0===n&&(n=!1),i=(i=void 0===i?!1:i)?(o=e.gx+e.halfWidth-(t.gx+t.halfWidth),e.gy+e.halfHeight-(t.gy+t.halfHeight)):(o=e.centerX-t.centerX,e.centerY-t.centerY),a=e.halfWidth+t.halfWidth,t=e.halfHeight+t.halfHeight,Math.abs(o)<a&&Math.abs(i)<t&&((a=a-Math.abs(o))>=(t=t-Math.abs(i))?(0<i?(r="top",e.y=e.y+t):(r="bottom",e.y=e.y-t),n&&(e.vy*=-1)):(0<o?(r="left",e.x=e.x+a):(r="right",e.x=e.x-a),n&&(e.vx*=-1))),r},k.circleCollision=function(e,t,n,i){var r,a,o,s={},l=!1;return void 0===n&&(n=!0),i=(i=void 0===i?!1:i)?(o=t.gx+t.radius-(e.gx+e.radius),t.gy+t.radius-(e.gy+e.radius)):(o=t.centerX-e.centerX,t.centerY-e.centerY),(r=Math.sqrt(o*o+i*i))<(t=e.radius+t.radius)&&(l=!0,t=t-r,a=i/r,e.x-=(t+=.3)*(o/r),e.y-=t*a,n)&&(s.x=i,s.y=-o,r=s,t={},a={},n={},o=(i=e).mass||1,r.lx=r.y,r.ly=-r.x,r.magnitude=Math.sqrt(r.x*r.x+r.y*r.y),r.dx=r.x/r.magnitude,r.dy=r.y/r.magnitude,s=i.vx*r.dx+i.vy*r.dy,t.vx=s*r.dx,t.vy=s*r.dy,a.vx=r.lx/r.magnitude*(s=i.vx*(r.lx/r.magnitude)+i.vy*(r.ly/r.magnitude)),a.vy=r.ly/r.magnitude*s,a.vx*=-1,a.vy*=-1,n.x=t.vx+a.vx,n.y=t.vy+a.vy,i.vx=n.x/o,i.vy=n.y/o),l},k.movingCircleCollision=function(e,t,n){var i,r={},a={},o={},s={},l={},c=!1;return e.mass=e.mass||1,t.mass=t.mass||1,(n=void 0===n?!1:n)?(r.vx=t.gx+t.radius-(e.gx+e.radius),r.vy=t.gy+t.radius-(e.gy+e.radius)):(r.vx=t.centerX-e.centerX,r.vy=t.centerY-e.centerY),r.magnitude=Math.sqrt(r.vx*r.vx+r.vy*r.vy),n=e.radius+t.radius,r.magnitude<n&&(c=!0,n=n-r.magnitude,n+=.3,r.dx=r.vx/r.magnitude,r.dy=r.vy/r.magnitude,r.vxHalf=Math.abs(r.dx*n/2),r.vyHalf=Math.abs(r.dy*n/2),n=e.x>t.x?1:-1,i=t.y<e.y?1:-1,e.x=e.x+r.vxHalf*n,e.y=e.y+r.vyHalf*i,t.x=t.x+r.vxHalf*-n,t.y=t.y+r.vyHalf*-i,r.lx=r.vy,r.ly=-r.vx,a.x=(n=e.vx*r.dx+e.vy*r.dy)*r.dx,a.y=n*r.dy,o.x=r.lx/r.magnitude*(i=e.vx*(r.lx/r.magnitude)+e.vy*(r.ly/r.magnitude)),o.y=r.ly/r.magnitude*i,s.x=(n=t.vx*r.dx+t.vy*r.dy)*r.dx,s.y=n*r.dy,l.x=r.lx/r.magnitude*(i=t.vx*(r.lx/r.magnitude)+t.vy*(r.ly/r.magnitude)),l.y=r.ly/r.magnitude*i,e.bounce={},e.bounce.x=o.x+s.x,e.bounce.y=o.y+s.y,t.bounce={},t.bounce.x=a.x+l.x,t.bounce.y=a.y+l.y,e.vx=e.bounce.x/e.mass,e.vy=e.bounce.y/e.mass,t.vx=t.bounce.x/t.mass,t.vy=t.bounce.y/t.mass),c},k.multipleCircleCollision=function(e,t){void 0===t&&(t=!1);for(var n=0;n<e.length;n++)for(var i=e[n],r=n+1;r<e.length;r++)k.movingCircleCollision(i,e[r],t)},k.circlePointCollision=function(e,t,n,i){return void 0===i&&(i=!1),void 0===n&&(n=!1),t.diameter=1,t.radius=.5,t.centerX=t.x,t.centerY=t.y,t.gx=t.x,t.gy=t.y,k.circleCollision(e,t,n,i)},k.circleRectangleCollision=function(e,t,n,i){var r,a,o,s,l;if(void 0===n&&(n=!1),l=(i=void 0===i?!1:i)?(a=e.gx,o=e.gy,s=t.gx,t.gy):(a=e.x,o=e.y,s=t.x,t.y),"topMiddle"==(o=o<l-t.halfHeight?a<s-1-t.halfWidth?"topLeft":a>s+1+t.halfWidth?"topRight":"topMiddle":o>l+t.halfHeight?a<s-1-t.halfWidth?"bottomLeft":a>s+1+t.halfWidth?"bottomRight":"bottomMiddle":a<s-t.halfWidth?"leftMiddle":"rightMiddle")||"bottomMiddle"==o||"leftMiddle"==o||"rightMiddle"==o)r=k.rectangleCollision(e,t,n,i);else{var c={};switch(o){case"topLeft":c.x=s,c.y=l;break;case"topRight":c.x=s+t.width,c.y=l;break;case"bottomLeft":c.x=s,c.y=l+t.height;break;case"bottomRight":c.x=s+t.width,c.y=l+t.height}r=k.circlePointCollision(e,c,n,i)}return r&&o},k.hit=function(e,t,o,s,l,n){var i;if(o=o||!1,s=s||!1,l=l||!1,t instanceof Array||e instanceof Array)for(var r=(t=e instanceof Array?e:t).length-1;0<=r;r--){var a=t[r];(i=c(e,a))&&n&&n(i,a)}else(i=c(e,t))&&n&&n(i);return i;function c(e,t){var n,i,r=void 0!==e.parent,a=void 0!==t.parent;if(r&&a)return e.diameter&&t.diameter?(r=e,i=t,o?r.vx+r.vy!==0&&i.vx+i.vy!==0?k.movingCircleCollision(r,i,l):k.circleCollision(r,i,s,l):k.hitTestCircle(r,i,l)):e.diameter&&!t.diameter?(r=e,i=t,o?k.circleRectangleCollision(r,i,s,l):k.hitTestCircleRectangle(r,i,l)):(r=e,n=t,o?s?k.rectangleCollision(r,n,!0,l):k.rectangleCollision(r,n,!1,l):k.hitTestRectangle(r,n,l));if(a&&void 0!==e.x&&void 0!==e.y)return k.hitTestPoint(e,t);throw new Error("I'm sorry, "+e+" and "+t+" cannot be use together in a collision test.")}},k.getIndex=function(e,t,n,i,r){var a={};return a.x=Math.floor(e/n),a.y=Math.floor(t/i),a.x+a.y*r},k.getTile=function(e,t,n){var i={};return i.gid=t[e],i.width=n.tilewidth,i.height=n.tileheight,i.halfWidth=n.tilewidth/2,i.halfHeight=n.tileheight/2,i.x=e%n.widthInTiles*n.tilewidth+n.x,i.y=Math.floor(e/n.widthInTiles)*n.tileheight+n.y,i.gx=i.x,i.gy=i.y,i.centerX=i.x+n.tilewidth/2,i.centery=i.y+n.tileheight/2,i},k.surroundingCells=function(e,t){return[e-t-1,e-t,e-t+1,e-1,e,e+1,e+t-1,e+t,e+t+1]},k.getPoints=function(e){var t=e.collisionArea;return void 0!==t?{topLeft:{x:e.x+t.x,y:e.y+t.y},topRight:{x:e.x+t.x+t.width,y:e.y+t.y},bottomLeft:{x:e.x+t.x,y:e.y+t.y+t.height},bottomRight:{x:e.x+t.x+t.width,y:e.y+t.y+t.height}}:{topLeft:{x:e.x,y:e.y},topRight:{x:e.x+e.width-1,y:e.y},bottomLeft:{x:e.x,y:e.y+e.height-1},bottomRight:{x:e.x+e.width-1,y:e.y+e.height-1}}},k.hitTestTile=function(t,n,i,r,e){var a={};switch(e=e||"some"){case"center":var o={center:{x:t.centerX,y:t.centerY}};t.collisionPoints=o,a.hit=Object.keys(t.collisionPoints).some(s);break;case"every":t.collisionPoints=k.getPoints(t),a.hit=Object.keys(t.collisionPoints).every(s);break;case"some":t.collisionPoints=k.getPoints(t),a.hit=Object.keys(t.collisionPoints).some(s)}function s(e){e=t.collisionPoints[e];return a.index=k.getIndex(e.x,e.y,r.tilewidth,r.tileheight,r.widthInTiles),a.gid=n[a.index],a.gid===i}return a},k.updateMap=function(e,t,n){var i=e.map(function(e){return 0});return t instanceof Array?t.forEach(function(e){e.index=k.getIndex(e.centerX,e.centerY,n.tilewidth,n.tileheight,n.widthInTiles),i[e.index]=e.gid}):((e=t).index=k.getIndex(e.centerX,e.centerY,n.tilewidth,n.tileheight,n.widthInTiles),i[e.index]=e.gid),i},k.fourKeyController=function(e,t,n,i,r,a){e.direction="",leftArrow=k.keyboard(a),upArrow=k.keyboard(n),rightArrow=k.keyboard(i),downArrow=k.keyboard(r),leftArrow.press=function(){e.vx=-t,e.vy=0,e.direction="left"},leftArrow.release=function(){rightArrow.isDown||0!==e.vy||(e.vx=0)},upArrow.press=function(){e.vy=-t,e.vx=0,e.direction="up"},upArrow.release=function(){downArrow.isDown||0!==e.vx||(e.vy=0)},rightArrow.press=function(){e.vx=t,e.vy=0,e.direction="right"},rightArrow.release=function(){leftArrow.isDown||0!==e.vy||(e.vx=0)},downArrow.press=function(){e.vy=t,e.vx=0,e.direction="down"},downArrow.release=function(){upArrow.isDown||0!==e.vx||(e.vy=0)}},k.makeTiledWorld=function(d,u){d=k.json(d);var h=k.group(),f=(h.tileheight=d.tileheight,h.tilewidth=d.tilewidth,h.width=d.width*d.tilewidth,h.height=d.height*d.tileheight,h.widthInTiles=d.width,h.heightInTiles=d.height,h.objects=[],d.tilesets[0].spacing),g=Math.floor(d.tilesets[0].imagewidth/(d.tilewidth+f));return d.layers.forEach(function(t){var c=k.group();Object.keys(t).forEach(function(e){"width"!==e&&"height"!==e&&(c[e]=t[e])}),c.alpha=t.opacity,h.addChild(c),h.objects.push(c),"tilelayer"===t.type&&t.data.forEach(function(e,t){var n,i,r,a,o,s,l;0!==e&&(i=t%h.widthInTiles,r=Math.floor(t/h.widthInTiles),i=i*h.tilewidth,r=r*h.tileheight,o=(e-1)%g,a=Math.floor((e-1)/g),o=o*h.tilewidth,a=a*h.tileheight,0<f&&(o+=f+f*((e-1)%g),a+=f+f*Math.floor((e-1)/g)),o=k.frame(u,o,a,h.tilewidth,h.tileheight),s=d.tilesets[0].tileproperties,l=String(e-1),s[l]&&s[l].name?(n=k.sprite(o),Object.keys(s[l]).forEach(function(e){n[e]=s[l][e]}),h.objects.push(n)):n=k.sprite(o),n.x=i,n.y=r,n.index=t,n.gid=e,c.addChild(n))}),"objectgroup"===t.type&&t.objects.forEach(function(e){(e.group=c).width=h.width,c.height=h.height,h.objects.push(e)})}),h.getObject=function(n){return this.searchForObject=function(){var t;if(h.objects.some(function(e){if(e.name&&e.name===n)return t=e,!0}),t)return t},this.searchForObject()},h.getObjects=function(e){var t=Array.prototype.slice.call(arguments),n=[];return h.objects.forEach(function(e){e.name&&-1!==t.indexOf(e.name)&&n.push(e)}),n},h},k.fullscreenScale=1,k.requestFullScreen=function(){document.fullscreenEnabled||k.canvas.requestFullscreen()},k.exitFullScreen=function(){document.fullscreenEnabled&&document.exitFullscreen()},k.alignFullscreen=function(){var e=screen.width/k.canvas.width,t=screen.height/k.canvas.height,t=(k.fullscreenScale=Math.min(e,t),0===document.styleSheets.length&&((e=document.createElement("div")).innerHTML="<style></style>",document.body.appendChild(e)),navigator.userAgent.toLowerCase());k.canvas.width>k.canvas.height?-1!==t.indexOf("safari")||-1!==t.indexOf("chrome")?document.styleSheets[0].insertRule("canvas:-webkit-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain}",0):-1!==t.indexOf("firefox")?document.styleSheets[0].insertRule("canvas:-moz-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==t.indexOf("opera")?document.styleSheets[0].insertRule("canvas:-o-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==t.indexOf("explorer")?document.styleSheets[0].insertRule("canvas:-ms-full-screen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):document.styleSheets[0].insertRule("canvas:fullscreen {position: fixed; width: 100%; height: auto; top: 0; right: 0; bottom: 0; left: 0; margin: auto; object-fit: contain;}",0):-1!==t.indexOf("safari")||-1!==t.indexOf("chrome")?document.styleSheets[0].insertRule("canvas:-webkit-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==t.indexOf("firefox")?document.styleSheets[0].insertRule("canvas:-moz-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==t.indexOf("opera")?document.styleSheets[0].insertRule("canvas:-o-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):-1!==t.indexOf("msie")?document.styleSheets[0].insertRule("canvas:-ms-full-screen {height: 100%; margin: 0 auto; object-fit: contain;}",0):document.styleSheets[0].insertRule("canvas:fullscreen {height: 100%; margin: 0 auto; object-fit: contain;}",0)},k.enableFullscreen=function(e){e=e&&Array.prototype.slice.call(arguments),k.alignFullscreen(),k.canvas.addEventListener("mouseup",k.requestFullScreen,!1),k.canvas.addEventListener("touchend",k.requestFullScreen,!1),e&&e.forEach(function(t){window.addEventListener("keyup",function(e){e.keyCode===t&&k.exitFullScreen(),e.preventDefault()},!1)})},k.launchFullscreen=function(e){k.hitTestPoint(k.pointer.position,e)&&k.enableFullscreen()},k.scaleFullscreen=function(){document.fullscreenEnabled?(k.scale=k.fullscreenScale,k.pointer.scale=k.fullscreenScale):k.canvas.scaled||(k.scale=1,k.pointer.scale=1)},k.updateFunctions.push(k.scaleFullscreen),k.actx=new AudioContext,k.makeSound=function(t,n){var i={},r=k.actx;return i.volumeNode=k.actx.createGain(),r.createStereoPanner?i.panNode=r.createStereoPanner():i.panNode=r.createPanner(),i.delayNode=r.createDelay(),i.feedbackNode=r.createGain(),i.filterNode=r.createBiquadFilter(),i.convolverNode=r.createConvolver(),i.soundNode=null,i.buffer=null,i.source=null,i.loop=!1,i.playing=!1,i.loadHandler=void 0,i.panValue=0,i.volumeValue=1,i.startTime=0,i.startOffset=0,i.playbackRate=1,i.echo=!1,i.delayValue=.3,i.feebackValue=.3,i.filterValue=0,i.reverb=!1,i.reverbImpulse=null,i.play=function(){i.startTime=r.currentTime,i.soundNode=r.createBufferSource(),i.soundNode.buffer=i.buffer,i.soundNode.playbackRate.value=this.playbackRate,i.soundNode.connect(i.volumeNode),!1===i.reverb?i.volumeNode.connect(i.panNode):(i.volumeNode.connect(i.convolverNode),i.convolverNode.connect(i.panNode),i.convolverNode.buffer=i.reverbImpulse),i.panNode.connect(r.destination),i.echo&&(i.feedbackNode.gain.value=i.feebackValue,i.delayNode.delayTime.value=i.delayValue,i.filterNode.frequency.value=i.filterValue,i.delayNode.connect(i.feedbackNode),(0<i.filterValue?(i.feedbackNode.connect(i.filterNode),i.filterNode):i.feedbackNode).connect(i.delayNode),i.volumeNode.connect(i.delayNode),i.delayNode.connect(i.panNode)),i.soundNode.loop=i.loop,i.soundNode.start(0,i.startOffset%i.buffer.duration),i.playing=!0},i.pause=function(){i.playing&&(i.soundNode.stop(0),i.startOffset+=r.currentTime-i.startTime,i.playing=!1)},i.restart=function(){i.playing&&i.soundNode.stop(0),i.startOffset=0,i.play()},i.playFrom=function(e){i.playing&&i.soundNode.stop(0),i.startOffset=e,i.play()},i.setEcho=function(e,t,n){void 0===t&&(t=.3),void 0===n&&(n=0),i.delayValue=e=void 0===e?.3:e,i.feebackValue=t,i.filterValue=n,i.echo=!0},i.setReverb=function(e,t,n){i.reverbImpulse=k.impulseResponse(e=void 0===e?2:e,t=void 0===t?2:t,n=void 0===n?!1:n,r),i.reverb=!0},i.fade=function(e,t){i.playing&&(i.volumeNode.gain.linearRampToValueAtTime(i.volumeNode.gain.value,r.currentTime),i.volumeNode.gain.linearRampToValueAtTime(e,r.currentTime+t))},i.fadeIn=function(e){i.volumeNode.gain.value=0,i.fade(1,e)},i.fadeOut=function(e){i.fade(0,e)},Object.defineProperties(i,{volume:{get:function(){return i.volumeValue},set:function(e){i.volumeNode.gain.value=e,i.volumeValue=e},enumerable:!0,configurable:!0},pan:{get:function(){return r.createStereoPanner?i.panNode.pan.value:i.panValue},set:function(e){var t,n;r.createStereoPanner?i.panNode.pan.value=e:(t=e,n=1-Math.abs(t),i.panNode.setPosition(t,0,n),i.panValue=e)},enumerable:!0,configurable:!0}}),i.load=function(){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.addEventListener("load",function(){r.decodeAudioData(e.response,function(e){i.buffer=e,i.hasLoaded=!0,n&&n()},function(e){throw new Error("Audio could not be decoded: "+e)})}),e.send()},i.load(),i},k.sound=function(e){return k.assets[e]},k.soundEffect=function(e,n,i,t,r,a,o,s,l,c,d,u,h){void 0===e&&(e=200),void 0===n&&(n=0),void 0===i&&(i=1),void 0===t&&(t="sine"),void 0===r&&(r=1),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=!1),void 0===c&&(c=0),void 0===d&&(d=0),void 0===u&&(u=void 0),void 0===h&&(h=void 0);var f,g,p,v=k.actx;function y(e){var t=v.createConvolver();t.buffer=k.impulseResponse(h[0],h[1],h[2],v),e.connect(t),t.connect(g)}function m(e){var t=v.createGain(),n=v.createDelay(),i=v.createBiquadFilter();n.delayTime.value=u[0],t.gain.value=u[1],u[2]&&(i.frequency.value=u[2]),n.connect(t),(u[2]?(t.connect(i),i):t).connect(n),e.connect(n),n.connect(g)}function x(e){e.gain.value=0,e.gain.linearRampToValueAtTime(0,v.currentTime+o),e.gain.linearRampToValueAtTime(r,v.currentTime+o+n)}function w(e){e.gain.linearRampToValueAtTime(r,v.currentTime+n+o),e.gain.linearRampToValueAtTime(0,v.currentTime+o+n+i)}function b(e){var t=e.frequency.value;l?(e.frequency.linearRampToValueAtTime(t,v.currentTime+o),e.frequency.linearRampToValueAtTime(t+s,v.currentTime+o+n+i)):(e.frequency.linearRampToValueAtTime(t,v.currentTime+o),e.frequency.linearRampToValueAtTime(t-s,v.currentTime+o+n+i))}function S(e){e.start(v.currentTime+o)}f=v.createOscillator(),p=v.createGain(),g=v.createStereoPanner?v.createStereoPanner():v.createPanner(),f.connect(p),p.connect(g),g.connect(v.destination),p.gain.value=r,v.createStereoPanner?g.pan.value=a:g.setPosition(a,0,1-Math.abs(a)),f.type=t,c=0<c?(a=e-c/2,t=e+c/2,Math.floor(Math.random()*(t-a+1))+a):e,f.frequency.value=c,0<n&&x(p),w(p),0<s&&b(f),u&&m(p),h&&y(p),0<d&&(t=v.createOscillator(),a=v.createOscillator(),e=v.createGain(),p=v.createGain(),e.gain.value=r,p.gain.value=r,t.connect(e),e.connect(v.destination),a.connect(p),p.connect(v.destination),t.type="sawtooth",a.type="sawtooth",t.frequency.value=c+d,a.frequency.value=c-d,0<n&&(x(e),x(p)),0<i&&(w(e),w(p)),0<s&&(b(t),b(a)),u&&(m(e),m(p)),h&&(y(e),y(p)),S(t),S(a)),S(f)},k.impulseResponse=function(e,t,n,i){for(var r=i.sampleRate*e,e=i.createBuffer(2,r,i.sampleRate),a=e.getChannelData(0),o=e.getChannelData(1),s=0;s<r;s++){var l=n?r-s:s;a[s]=(2*Math.random()-1)*Math.pow(1-l/r,t),o[s]=(2*Math.random()-1)*Math.pow(1-l/r,t)}return e}};let t,n,i,r,a,o,s=e.create(800,512,function(){a=s.group(),i=s.group(),n=s.group(t),c=s.group(),l=s.rectangle(50*s.canvas.width,100*s.canvas.height,"black","none",0,-1e3,-500),n.addChild(l),s.canvas.ctx.imageSmoothingEnabled=!1,s.canvas.style.border="2px black solid",s.backgroundColor="white";for(let e=0;e<100;e++)d.push(f(64*e,s.canvas.height,Math.floor(2*Math.random())+1));var e=64*d.length;s.stage.width=e,s.stage.height=5*s.canvas.height;for(let e=0;e<5;e++){var u=h(64*e,d[e].y-22);a.addChild(u)}var p=[];for(let e=0;e<1e3;e++){let e,t=0;for(;t<50;){let n=Math.floor(Math.random()*(10*s.canvas.width-64)),i=Math.floor(Math.random()*(5*s.canvas.height/2-64));if(!p.some(e=>{var t=e.x-n,e=e.y-i;return Math.sqrt(t*t+e*e)<100})){(e=s.sprite("../public/Star.png")).width=12,e.height=12,e.x=n,e.y=i,c.addChild(e),p.push(e);break}t++}}n.addChild(c),n.addChild(i),n.addChild(a),(r=s.rectangle(25,25,"yellow")).x=s.canvas.width-25,r.y=i.children[i.children.length-1].gy,n.addChild(r),(t=s.sprite("../public/Cat.png")).width=40,t.height=32,t.lastDropTime=0,t.dropCooldown=200,t.grounded=!1,t.x=s.canvas.width/2-t.width/2,t.layingMouses=s.group(),n.addChild(t),o=s.worldCamera(n,s.canvas),s.key.a.press=function(){if(t.vx=-3,t.scaleX=-1,0<t.layingMouses.children.length)for(let e=0;e<t.layingMouses.children.length;e++)t.layingMouses.children[e].scaleX=-1,t.layingMouses.children[e].offset=-5},s.key.a.release=function(){s.key.d.isDown||(t.vx=0)},s.key.d.press=function(){if(t.vx=3,t.scaleX=1,0<t.layingMouses.children.length)for(let e=0;e<t.layingMouses.children.length;e++)t.layingMouses.children[e].scaleX=1,t.layingMouses.children[e].offset=5},s.key.d.release=function(){s.key.a.isDown||(t.vx=0)},s.key.leftArrow.press=function(){if(t.vx=-3,t.scaleX=-1,0<t.layingMouses.children.length)for(let e=0;e<t.layingMouses.children.length;e++)t.layingMouses.children[e].scaleX=-1,t.layingMouses.children[e].offset=-5},s.key.leftArrow.release=function(){s.key.rightArrow.isDown||(t.vx=0)},s.key.rightArrow.press=function(){if(t.vx=3,t.scaleX=1,0<t.layingMouses.children.length)for(let e=0;e<t.layingMouses.children.length;e++)t.layingMouses.children[e].scaleX=1,t.layingMouses.children[e].offset=5},s.key.rightArrow.release=function(){s.key.leftArrow.isDown||(t.vx=0)},s.key.upArrow.press=function(){t.grounded,t.grounded&&(t.vy-=9,t.grounded=!1)},s.key.space.press=function(){t.grounded,t.grounded&&(t.vy-=9,t.grounded=!1)},s.key.w.press=function(){t.grounded,t.grounded&&(t.vy-=9,t.grounded=!1)},s.state=g},["../public/Cat.png","../public/Mouse_Stand.png","../public/Mouse_Lay.png","../public/Roof1.png","../public/Roof2.png","../public/Star.png","../public/WhiteFont.png"]);e.plugins(s),s.start(),s.scaleToWindow();let l,c,d=[],u=(window.addEventListener("resize",function(e){s.scaleToWindow()}),new class{constructor(){this.menuText=null,this.menuBackground=null}});function h(e,t){var n=s.sprite("../public/Mouse_Stand.png");return n.width=22,n.height=22,n.x=e,n.y=t,n}function f(t,n,e){let r=1===e?"Roof1.png":"Roof2.png",a=null,o=i.lastHeight||20,l=Math.max(1,o-2),c=o+2,d=Math.floor(Math.random()*(c-l+1))+l;for(let e=0;e<d;e++){var u=s.sprite("../public/"+r);u.width=64,u.height=32,u.x=t,u.y=n-32*e,i.addChild(u),(!a||u.y<a.y)&&(a=u)}return i.lastHeight=d,a}function g(){u.menuBackground||u.menuText||(u.menuBackground=s.rectangle(50*s.canvas.width,100*s.canvas.height,"black","none",0,-1e3,-500),s.stage.addChild(u.menuBackground),u.menuText=(t=>{var n=s.group();for(let e=0;e<t.length;e++){var i,r=t[e].toUpperCase(),r="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(r);-1!==r&&((i=s.sprite("../public/WhiteFont.png")).sourceX=5*r,i.sourceY=0,i.sourceWidth=5,i.sourceHeight=5,i.width=32,i.height=32,i.x=75+32*e,i.y=200,n.addChild(i))}return n})("THE MIDNIGHT EXPRESS"),s.stage.addChild(u.menuText)),s.key.space.isDown&&(s.remove(u.menuBackground),s.remove(u.menuText),s.state=p)}function p(){t.vy+=.4,s.move(t);for(let e=0;e<i.children.length;e++){let n=i.children[e];s.hit(t,n,!0,!1,!1,e=>{"top"===e?t.vy=0:"bottom"===e&&0<=t.vy?(t.vy=0,t.grounded=!0,t.y=n.y-t.height,t.vy=-.4):"left"!==e&&"right"!==e||(t.vx=0),"bottom"!==e&&0<t.vy&&(t.grounded=!1)})}for(let e=0;e<a.children.length;e++)a.children[e];for(let e=0;e<a.children.length;e++){let i=a.children[e];s.hit(t,i,!0,!1,!1,()=>{var e=s.sprite("../public/Mouse_Lay.png");e.width=20,e.height=20,e.x=t.x,e.y=t.y+10,t.layingMouses.addChild(e),n.addChild(t.layingMouses),a.removeChild(i)})}let r=t.x+(1===t.scaleX?3:19),l=t.y+5;for(let n=0;n<t.layingMouses.children.length;n++){let e=t.layingMouses.children[n];e.x=r,e.y=l-10*n}for(let e=0;e<c.children.length;e++)c.children[e].x-=.05;o.centerOver(t)}